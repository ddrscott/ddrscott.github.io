<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[@_ddrscott_]]></title>
  <link href="http://ddrscott.github.io/atom.xml" rel="self"/>
  <link href="http://ddrscott.github.io/"/>
  <updated>2017-04-13T14:40:42-05:00</updated>
  <id>http://ddrscott.github.io/</id>
  <author>
    <name><![CDATA[Scott Pierce]]></name>
    <email><![CDATA[ddrscott@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Base16 Shell]]></title>
    <link href="http://ddrscott.github.io/blog/2017/base16-shell/"/>
    <updated>2017-04-13T13:30:00-05:00</updated>
    <id>http://ddrscott.github.io/blog/2017/base16-shell</id>
    <content type="html"><![CDATA[<p><img class="featured" src="http://ddrscott.github.io/images/base16-featured.png" width="1024" height="558" title="'Base16 Featured'" ></p>

<p>After many years using the excellent Solarized color scheme, it has
started to feel stale. Sometimes I think the dark blueish tint brings
down my mood. Other times, I wonder what life could be like if I stared at more
cheerful colors. Thus starts my farewell from Solarized, and hello to
Base16.</p>

<!-- more -->


<p>From Base16&rsquo;s <a href="https://github.com/chriskempson/base16">Github README</a>:</p>

<blockquote><p>Base16 provides carefully chosen syntax highlighting and a default set of
sixteen colors suitable for a wide range of applications. Base16 is not a
single theme but a set of guidelines with numerous implementations.</p></blockquote>

<p>Which means after integrating into Base16 once, I&rsquo;ll have access to an
unlimited supply of themes in the future!</p>

<h2>Installation</h2>

<p>Base16 has perfect iTerm and shell integration. Once the repo was installed
locally, I called <code>base16_ocean</code> and was greeted by brand new palette. No iTerm
tweaking, no downloading this other thing and importing stuff into iTerm. It was
literally 2 steps performed in shell and then pick a theme.</p>

<p>Here&rsquo;s what you do. (FYI. This is pretty much copy/paste from their repo)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># 1. clone the repo to `~/.config/base16-shell`</span>
</span><span class='line'>git clone https://github.com/chriskempson/base16-shell.git ~/.config/base16-shell
</span><span class='line'>
</span><span class='line'><span class="c"># 2. update ~/.bashrc or ~/.zshrc</span>
</span><span class='line'>cat &gt;&gt; ~/.zshrc <span class="s">&lt;&lt;&#39;SH&#39;</span>
</span><span class='line'><span class="s">BASE16_SH</span>ELL<span class="o">=</span><span class="nv">$HOME</span>/.config/base16-shell/
</span><span class='line'><span class="o">[</span> -n <span class="s2">&quot;$PS1&quot;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">[</span> -s <span class="nv">$BASE16_SHELL</span>/profile_helper.sh <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">eval</span> <span class="s2">&quot;$($BASE16_SHELL/profile_helper.sh)&quot;</span>
</span><span class='line'>SH
</span></code></pre></td></tr></table></div></figure>


<p>After you&rsquo;re done with those steps, start a new terminal session or source the
file, and start choosing a theme. Try <code>base16_ocean</code> to see what I&rsquo;m seeing. Try
<code>base16_&lt;tab&gt;</code> to see what other options you have available. To preview what
they look like before making a choice go to their website:
<a href="https://chriskempson.github.io/base16/.">https://chriskempson.github.io/base16/.</a></p>

<h2>Vim Integration</h2>

<p>Install plugin from <a href="https://github.com/chriskempson/base16-vim.">https://github.com/chriskempson/base16-vim.</a></p>

<p>Add the following to your <code>.vimrc</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="k">if</span> filereadable<span class="p">(</span>expand<span class="p">(</span><span class="s2">&quot;~/.vimrc_background&quot;</span><span class="p">))</span>
</span><span class='line'>  <span class="k">let</span> base16colorspace<span class="p">=</span><span class="m">256</span>
</span><span class='line'>  source <span class="p">~</span>/.vimrc_background
</span><span class='line'><span class="k">endif</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>base16-shell</code> commands create the <code>~/.vimrc_background</code> file every time a
<code>base16_*</code> alias is used. This allows Vim to always stay synchronized with
shell which is AWESOME!</p>

<h2>Conclusion</h2>

<p>After cycling through everyone of the user created themes, I&rsquo;ve settled on
<code>base16_ocean</code> as my new home. I may get tired of it, I may not, but either way
I&rsquo;m just a shell command away from changing. Indecision has never been so easy.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Vim Send Text]]></title>
    <link href="http://ddrscott.github.io/blog/2017/vim-send-text/"/>
    <updated>2017-04-10T13:30:00-05:00</updated>
    <id>http://ddrscott.github.io/blog/2017/vim-send-text</id>
    <content type="html"><![CDATA[<p><img class="featured" src="https://raw.githubusercontent.com/ddrscott/vim-islime2/gh-pages/demo.gif" title="'Vim Send Text Demo'" ></p>

<p>After pairing with some Sublime users, I noticed a neat feature. Or more
accurately, they were rubbing it in my face that their cute editor was better
than mine. The feature was <a href="https://github.com/wch/SendText">SendText</a>. Well, I
couldn&rsquo;t let Sublime users have all the fun, and apparently neither could a few
other people.</p>

<!-- more -->


<h2>History</h2>

<p>There have been a few other implementations at this feature. These
implementations sent the text to a screen or tmux split. Since I don&rsquo;t use
either, I couldn&rsquo;t use them a la carte.</p>

<ul>
<li><a href="https://github.com/vim-scripts/tslime.vim">https://github.com/vim-scripts/tslime.vim</a></li>
<li><a href="https://github.com/jpalardy/vim-slime">https://github.com/jpalardy/vim-slime</a></li>
<li><a href="https://github.com/ervandew/screen">https://github.com/ervandew/screen</a></li>
</ul>


<p>This next implementation was good. It&rsquo;s only flaw, IMHO, was it&rsquo;s mappings and
naming. The naming &ldquo;ISlime2&rdquo; is impossible for me to type on the first try. The
mappings overlapped my existing mappings.
<a href="https://github.com/matschaffer/vim-islime2">ISlime2</a> did all the hard work
AppleScript work and provides the Vim function to pass into the AppleScript.</p>

<p>Enter <a href="https://github.com/ddrscott/vim-sendtext">vim-sendtext</a>.
<a href="https://github.com/ddrscott/vim-sendtext">vim-sendtext</a> is a fork of <a href="https://github.com/matschaffer/vim-islime2">ISlime2</a>.
My fork removes all the mappings, exposes useful internal functions, and adds
recommended mappings to the README.md.</p>

<h2>Recommended Mappings</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="c">&quot; Send current line</span>
</span><span class='line'><span class="nb">nnoremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;</span> <span class="p">&lt;</span>Leader<span class="p">&gt;</span><span class="k">i</span><span class="p">&lt;</span>CR<span class="p">&gt;</span> :SendTextCurrentLine<span class="p">&lt;</span>CR<span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="c">&quot; Send in/around text object - operation pending</span>
</span><span class='line'><span class="nb">nnoremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;</span> <span class="p">&lt;</span>Leader<span class="p">&gt;</span><span class="k">i</span> :<span class="k">set</span> <span class="nb">opfunc</span><span class="p">=</span>sendtext#iTermSendOperator<span class="p">&lt;</span>CR<span class="p">&gt;</span><span class="k">g</span>@
</span><span class='line'>
</span><span class='line'><span class="c">&quot; Send visual selection</span>
</span><span class='line'><span class="nb">vnoremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;</span> <span class="p">&lt;</span>Leader<span class="p">&gt;</span><span class="k">i</span> :<span class="p">&lt;</span>C<span class="p">-</span><span class="k">u</span><span class="p">&gt;</span><span class="k">call</span> sendtext#iTermSendOperator<span class="p">(</span>visualmode<span class="p">(),</span> <span class="m">1</span><span class="p">)&lt;</span>CR<span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="c">&quot; Move to next line then send it</span>
</span><span class='line'><span class="nb">nnoremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;</span> <span class="p">&lt;</span>Leader<span class="p">&gt;</span><span class="k">ij</span> :SendTextNextLine<span class="p">&lt;</span>CR<span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="c">&quot; Move to previous line then send it</span>
</span><span class='line'><span class="nb">nnoremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;</span> <span class="p">&lt;</span>Leader<span class="p">&gt;</span>ik :SendTextPreviousLine<span class="p">&lt;</span>CR<span class="p">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Vim Operator Pending</h2>

<p>One of the main reasons to use Vim is Operator pending.  It&rsquo;s at the heart of
<code>vip</code>, <code>dip</code>, <code>ciw</code>, etc.
<a href="https://github.com/ddrscott/vim-sendtext">vim-sendtext</a> provides an operator
pending function so we can logically do <code>{SEND}ap</code>, <code>{SEND}ip</code>, <code>{SEND}if</code>, etc.
The identical function works in visual mode to help build confidence in our text
object targets.</p>

<p>To read more about operator pending functions and how to create them try:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="p">:</span><span class="k">h</span> map<span class="p">-</span>operator
</span></code></pre></td></tr></table></div></figure>


<h2>Conclusion</h2>

<p>Hope <a href="https://github.com/ddrscott/vim-sendtext">vim-sendtext</a> can remove some
feature envy from Sublime. Happy console hacking!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[What the SQL?!? WINDOW]]></title>
    <link href="http://ddrscott.github.io/blog/2017/what-the-sql-window/"/>
    <updated>2017-03-22T13:30:00-05:00</updated>
    <id>http://ddrscott.github.io/blog/2017/what-the-sql-window</id>
    <content type="html"><![CDATA[<p><img class="featured" src="http://ddrscott.github.io/images/what_the_sql_window.png" width="1079" height="369" title="'What the SQL?!?  WINDOW'" ></p>

<p>Today&rsquo;s &ldquo;What the SQL?!?&rdquo; features the keyword <code>WINDOW</code>. This clause allows
us to elegantly select results from the previous results from the previous results
from the previous results&hellip;</p>

<!-- more -->


<p>Please note, our target database is PostgreSQL. These examples may work with
other databases, but might need some massaging to get them to work properly.
Search online for the specific vendor&rsquo;s documentation if errors pop up.
Try searching for &ldquo;WINDOW queries &rdquo;. Not all database vendors
support the keyword <code>WINDOW</code>.</p>

<h2>Create Sample Data</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">IF</span> <span class="k">EXISTS</span> <span class="n">sample_moves</span><span class="p">;</span>
</span><span class='line'><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">sample_moves</span> <span class="k">AS</span>
</span><span class='line'>  <span class="k">SELECT</span>
</span><span class='line'>    <span class="n">column1</span><span class="p">::</span><span class="nb">int</span>     <span class="k">AS</span> <span class="n">id</span><span class="p">,</span>
</span><span class='line'>    <span class="n">column2</span><span class="p">::</span><span class="nb">varchar</span> <span class="k">AS</span> <span class="n">name</span><span class="p">,</span>
</span><span class='line'>    <span class="n">column3</span><span class="p">::</span><span class="nb">varchar</span> <span class="k">AS</span> <span class="n">address</span><span class="p">,</span>
</span><span class='line'>    <span class="n">column4</span><span class="p">::</span><span class="nb">date</span> <span class="k">AS</span> <span class="n">moved_at</span>
</span><span class='line'>  <span class="k">FROM</span> <span class="p">(</span>
</span><span class='line'>    <span class="k">VALUES</span>
</span><span class='line'>      <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Alice&#39;</span> <span class="p">,</span> <span class="s1">&#39;1 Main St&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-01-01&#39;</span><span class="p">),</span>
</span><span class='line'>      <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span>   <span class="p">,</span> <span class="s1">&#39;2 Main St&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-02-01&#39;</span><span class="p">),</span>
</span><span class='line'>      <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Cat&#39;</span>   <span class="p">,</span> <span class="s1">&#39;2 Main St&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-03-01&#39;</span><span class="p">),</span>
</span><span class='line'>      <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;Dan Sr&#39;</span>  <span class="p">,</span> <span class="s1">&#39;3 Main St&#39;</span><span class="p">,</span>  <span class="s1">&#39;1970-04-01&#39;</span><span class="p">),</span>
</span><span class='line'>      <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;Dan Jr&#39;</span>  <span class="p">,</span> <span class="s1">&#39;3 Main St&#39;</span><span class="p">,</span>  <span class="s1">&#39;2001-04-01&#39;</span><span class="p">),</span>
</span><span class='line'>      <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;Dan 3rd&#39;</span> <span class="p">,</span> <span class="s1">&#39;3 Main St&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-04-01&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">)</span> <span class="k">as</span> <span class="n">t</span>
</span><span class='line'><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">CREATE</span> <span class="k">INDEX</span> <span class="k">ON</span> <span class="n">sample_moves</span><span class="p">(</span><span class="n">address</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">sample_moves</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>Results:</h4>

<table>
<thead>
<tr>
<th></th>
<th> id </th>
<th>  name   </th>
<th>  address  </th>
<th>  moved_at</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>  1 </td>
<td> Alice   </td>
<td> 1 Main St </td>
<td> 2017-01-01</td>
</tr>
<tr>
<td></td>
<td>  2 </td>
<td> Bob     </td>
<td> 2 Main St </td>
<td> 2017-02-01</td>
</tr>
<tr>
<td></td>
<td>  3 </td>
<td> Cat     </td>
<td> 2 Main St </td>
<td> 2017-03-01</td>
</tr>
<tr>
<td></td>
<td>  4 </td>
<td> Dan Sr  </td>
<td> 3 Main St </td>
<td> 1970-04-01</td>
</tr>
<tr>
<td></td>
<td>  5 </td>
<td> Dan Jr  </td>
<td> 3 Main St </td>
<td> 2001-04-01</td>
</tr>
<tr>
<td></td>
<td>  6 </td>
<td> Dan 3rd </td>
<td> 3 Main St </td>
<td> 2017-04-01</td>
</tr>
</tbody>
</table>


<h2>Life Without Windows</h2>

<p>A quick poem&hellip;</p>

<blockquote><p>Eyes big and wide,     <br/>
nothing seen inside.   <br/>
Feeling around         <br/>
nothing abound.        <br/>
This things wet,       <br/>
toxic I bet.           <br/>
Closing my eyes,       <br/>
still can&rsquo;t rest.      <br/>
Having a window,       <br/>
would be best.         <br/></p></blockquote>

<h3>How many people live at each address?</h3>

<p>Using a standard <code>GROUP BY</code> with <code>COUNT</code> we consolidate the records and count
how many rows belong to each address.</p>

<blockquote><p><strong>Tip</strong>: <code>COUNT(1)</code> is more efficient than <code>COUNT(*)</code>.</p></blockquote>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span>
</span><span class='line'>  <span class="n">address</span><span class="p">,</span>
</span><span class='line'>  <span class="k">COUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">total</span>
</span><span class='line'><span class="k">FROM</span> <span class="n">sample_moves</span>
</span><span class='line'><span class="k">GROUP</span> <span class="k">BY</span> <span class="n">address</span>
</span><span class='line'><span class="k">ORDER</span> <span class="k">BY</span> <span class="n">address</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>Results:</h4>

<table>
<thead>
<tr>
<th></th>
<th>  address  </th>
<th> total</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td> 1 Main St </td>
<td>     1</td>
</tr>
<tr>
<td></td>
<td> 2 Main St </td>
<td>     2</td>
</tr>
<tr>
<td></td>
<td> 3 Main St </td>
<td>     3</td>
</tr>
</tbody>
</table>


<h3>How many people live with each person?</h3>

<p>Enter subquery land. Life without windows is not exciting.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span>
</span><span class='line'>  <span class="o">*</span><span class="p">,</span>
</span><span class='line'>  <span class="p">(</span>
</span><span class='line'>    <span class="k">SELECT</span>
</span><span class='line'>      <span class="c1">-- everyone at the address, minus the person</span>
</span><span class='line'>      <span class="k">COUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span class='line'>    <span class="k">FROM</span> <span class="n">sample_moves</span> <span class="n">t2</span>
</span><span class='line'>    <span class="k">WHERE</span> <span class="n">t2</span><span class="p">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">t1</span><span class="p">.</span><span class="n">address</span>
</span><span class='line'>  <span class="p">)</span> <span class="k">AS</span> <span class="n">others</span>
</span><span class='line'><span class="k">FROM</span> <span class="n">sample_moves</span> <span class="n">t1</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>Results:</h4>

<table>
<thead>
<tr>
<th></th>
<th> id </th>
<th>  name   </th>
<th>  address  </th>
<th>  moved_at  </th>
<th> others</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>  1 </td>
<td> Alice   </td>
<td> 1 Main St </td>
<td> 2017-01-01 </td>
<td>      0</td>
</tr>
<tr>
<td></td>
<td>  2 </td>
<td> Bob     </td>
<td> 2 Main St </td>
<td> 2017-02-01 </td>
<td>      1</td>
</tr>
<tr>
<td></td>
<td>  3 </td>
<td> Cat     </td>
<td> 2 Main St </td>
<td> 2017-03-01 </td>
<td>      1</td>
</tr>
<tr>
<td></td>
<td>  4 </td>
<td> Dan Sr  </td>
<td> 3 Main St </td>
<td> 1970-04-01 </td>
<td>      2</td>
</tr>
<tr>
<td></td>
<td>  5 </td>
<td> Dan Jr  </td>
<td> 3 Main St </td>
<td> 2001-04-01 </td>
<td>      2</td>
</tr>
<tr>
<td></td>
<td>  6 </td>
<td> Dan 3rd </td>
<td> 3 Main St </td>
<td> 2017-04-01 </td>
<td>      2</td>
</tr>
</tbody>
</table>


<h3><code>JOIN</code> works, too</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span>
</span><span class='line'>  <span class="n">t1</span><span class="p">.</span><span class="o">*</span><span class="p">,</span>
</span><span class='line'>  <span class="n">t2</span><span class="p">.</span><span class="n">others</span>
</span><span class='line'><span class="k">FROM</span> <span class="n">sample_moves</span> <span class="n">t1</span>
</span><span class='line'><span class="k">JOIN</span> <span class="p">(</span>
</span><span class='line'>  <span class="k">SELECT</span>
</span><span class='line'>    <span class="n">address</span><span class="p">,</span>
</span><span class='line'>    <span class="k">COUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">as</span> <span class="n">others</span>
</span><span class='line'>  <span class="k">FROM</span> <span class="n">sample_moves</span>
</span><span class='line'>  <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">address</span>
</span><span class='line'>  <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">address</span>
</span><span class='line'><span class="p">)</span> <span class="n">t2</span> <span class="k">USING</span> <span class="p">(</span><span class="n">address</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h3>And so does <code>JOIN LATERAL</code></h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span>
</span><span class='line'>  <span class="n">t1</span><span class="p">.</span><span class="o">*</span><span class="p">,</span>
</span><span class='line'>  <span class="n">t2</span><span class="p">.</span><span class="n">others</span>
</span><span class='line'><span class="k">FROM</span> <span class="n">sample_moves</span> <span class="n">t1</span>
</span><span class='line'><span class="k">JOIN</span> <span class="k">LATERAL</span> <span class="p">(</span>
</span><span class='line'>  <span class="k">SELECT</span>
</span><span class='line'>    <span class="n">address</span><span class="p">,</span>
</span><span class='line'>    <span class="k">COUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">as</span> <span class="n">others</span>
</span><span class='line'>  <span class="k">FROM</span> <span class="n">sample_moves</span> <span class="n">sub</span>
</span><span class='line'>  <span class="k">WHERE</span> <span class="n">sub</span><span class="p">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">t1</span><span class="p">.</span><span class="n">address</span>
</span><span class='line'>  <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">address</span>
</span><span class='line'>  <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">address</span>
</span><span class='line'><span class="p">)</span> <span class="n">t2</span> <span class="k">ON</span> <span class="k">true</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>That&rsquo;s nice, but who moved in first?</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span>
</span><span class='line'>  <span class="o">*</span><span class="p">,</span>
</span><span class='line'>  <span class="p">(</span>
</span><span class='line'>    <span class="k">SELECT</span>
</span><span class='line'>      <span class="k">COUNT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span class='line'>    <span class="k">FROM</span> <span class="n">sample_moves</span> <span class="n">t2</span>
</span><span class='line'>    <span class="k">WHERE</span> <span class="n">t2</span><span class="p">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">t1</span><span class="p">.</span><span class="n">address</span>
</span><span class='line'>  <span class="p">)</span> <span class="k">AS</span> <span class="n">others</span><span class="p">,</span>
</span><span class='line'>  <span class="p">(</span>
</span><span class='line'>    <span class="k">SELECT</span>
</span><span class='line'>      <span class="n">name</span>
</span><span class='line'>    <span class="k">FROM</span> <span class="n">sample_moves</span> <span class="n">t3</span>
</span><span class='line'>    <span class="k">WHERE</span> <span class="n">t3</span><span class="p">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">t1</span><span class="p">.</span><span class="n">address</span>
</span><span class='line'>    <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">moved_at</span> <span class="k">ASC</span>
</span><span class='line'>    <span class="k">LIMIT</span> <span class="mi">1</span>
</span><span class='line'>  <span class="p">)</span> <span class="k">AS</span> <span class="n">first_person</span>
</span><span class='line'><span class="k">FROM</span> <span class="n">sample_moves</span> <span class="n">t1</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Wait I thought this was about windows?!?</h2>

<p>The keyword <code>OVER</code> is the gateway drug into <code>WINDOW</code> functions. Using <code>OVER</code>
with parenthesis is an inline window. The <code>PARTITION BY</code> keywords gives similar
functionality to <code>GROUP BY</code> and <code>JOIN ... USING</code> all in one power packed
statement. It can never reduce the number of records in a result set which is
the same behavior expected of a correlated subquery.</p>

<p><code>PARTITION BY</code> is treated the same as the traditional <code>GROUP BY</code>. The <code>ORDER BY</code>
also has the same behavior as its use in a standard query.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span>
</span><span class='line'>  <span class="o">*</span><span class="p">,</span>
</span><span class='line'>  <span class="p">(</span><span class="k">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span><span class="n">PARTITION</span> <span class="k">BY</span> <span class="n">address</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>                      <span class="k">AS</span> <span class="n">others</span><span class="p">,</span>
</span><span class='line'>  <span class="n">first_value</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span><span class="n">PARTITION</span> <span class="k">BY</span> <span class="n">address</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">moved_at</span><span class="p">)</span> <span class="k">AS</span> <span class="n">first_moved</span>
</span><span class='line'><span class="k">FROM</span> <span class="n">sample_moves</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>Results</h4>

<table>
<thead>
<tr>
<th></th>
<th> id </th>
<th>  name   </th>
<th>  address  </th>
<th>  moved_at  </th>
<th> others </th>
<th> first_moved</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>  1 </td>
<td> Alice   </td>
<td> 1 Main St </td>
<td> 2017-01-01 </td>
<td>      0 </td>
<td> Alice</td>
</tr>
<tr>
<td></td>
<td>  2 </td>
<td> Bob     </td>
<td> 2 Main St </td>
<td> 2017-02-01 </td>
<td>      1 </td>
<td> Bob</td>
</tr>
<tr>
<td></td>
<td>  3 </td>
<td> Cat     </td>
<td> 2 Main St </td>
<td> 2017-03-01 </td>
<td>      1 </td>
<td> Bob</td>
</tr>
<tr>
<td></td>
<td>  4 </td>
<td> Dan Sr  </td>
<td> 3 Main St </td>
<td> 1970-04-01 </td>
<td>      2 </td>
<td> Dan Sr</td>
</tr>
<tr>
<td></td>
<td>  5 </td>
<td> Dan Jr  </td>
<td> 3 Main St </td>
<td> 2001-04-01 </td>
<td>      2 </td>
<td> Dan Sr</td>
</tr>
<tr>
<td></td>
<td>  6 </td>
<td> Dan 3rd </td>
<td> 3 Main St </td>
<td> 2017-04-01 </td>
<td>      2 </td>
<td> Dan Sr</td>
</tr>
</tbody>
</table>


<p>A picture with arrows worth a thousand words:</p>

<p><img class="featured" src="http://ddrscott.github.io/images/window_arrows.png" width="988" height="391" title="'Window SQL with arrows'" ></p>

<h2>That doesn&rsquo;t look very DRY. Finally, a <code>WINDOW</code></h2>

<p>The <code>WINDOW</code> keyword allows us to alias the options of the <code>OVER</code> clause. Namely
the expression <code>(...)</code> between and including the parenthesis.</p>

<p>In the following example we add the use of <code>RANGE</code> to provide additional
direction to the windowing clause.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span>
</span><span class='line'>  <span class="o">*</span><span class="p">,</span>
</span><span class='line'>  <span class="p">(</span><span class="k">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">OVER</span> <span class="n">w</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">AS</span> <span class="n">others</span><span class="p">,</span>
</span><span class='line'>  <span class="n">first_value</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="n">OVER</span> <span class="n">w</span> <span class="k">AS</span> <span class="n">first_moved</span><span class="p">,</span>
</span><span class='line'>  <span class="n">last_value</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>  <span class="n">OVER</span> <span class="n">w</span> <span class="k">AS</span> <span class="n">last_moved</span>
</span><span class='line'><span class="k">FROM</span> <span class="n">sample_moves</span>
</span><span class='line'><span class="n">WINDOW</span> <span class="n">w</span> <span class="k">AS</span> <span class="p">(</span>
</span><span class='line'>  <span class="n">PARTITION</span> <span class="k">BY</span> <span class="n">address</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">moved_at</span>
</span><span class='line'>  <span class="n">RANGE</span> <span class="k">BETWEEN</span> <span class="n">UNBOUNDED</span> <span class="n">PRECEDING</span> <span class="k">AND</span> <span class="n">UNBOUNDED</span> <span class="n">FOLLOWING</span>
</span><span class='line'><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h4>Results</h4>

<table>
<thead>
<tr>
<th></th>
<th> id </th>
<th>  name   </th>
<th>  address  </th>
<th>  moved_at  </th>
<th> others </th>
<th> first_moved </th>
<th> last_moved</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>  1 </td>
<td> Alice   </td>
<td> 1 Main St </td>
<td> 2017-01-01 </td>
<td>      0 </td>
<td> Alice       </td>
<td> Alice</td>
</tr>
<tr>
<td></td>
<td>  2 </td>
<td> Bob     </td>
<td> 2 Main St </td>
<td> 2017-02-01 </td>
<td>      0 </td>
<td> Bob         </td>
<td> Bob</td>
</tr>
<tr>
<td></td>
<td>  3 </td>
<td> Cat     </td>
<td> 2 Main St </td>
<td> 2017-03-01 </td>
<td>      1 </td>
<td> Bob         </td>
<td> Cat</td>
</tr>
<tr>
<td></td>
<td>  4 </td>
<td> Dan Sr  </td>
<td> 3 Main St </td>
<td> 1970-04-01 </td>
<td>      0 </td>
<td> Dan Sr      </td>
<td> Dan Sr</td>
</tr>
<tr>
<td></td>
<td>  5 </td>
<td> Dan Jr  </td>
<td> 3 Main St </td>
<td> 2001-04-01 </td>
<td>      1 </td>
<td> Dan Sr      </td>
<td> Dan Jr</td>
</tr>
<tr>
<td></td>
<td>  6 </td>
<td> Dan 3rd </td>
<td> 3 Main St </td>
<td> 2017-04-01 </td>
<td>      2 </td>
<td> Dan Sr      </td>
<td> Dan 3rd</td>
</tr>
</tbody>
</table>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="c1">-- Previous and Next Record</span>
</span><span class='line'><span class="k">SELECT</span>
</span><span class='line'>  <span class="o">*</span><span class="p">,</span>
</span><span class='line'>  <span class="p">(</span><span class="k">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">OVER</span> <span class="n">w</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">AS</span> <span class="n">others</span><span class="p">,</span>
</span><span class='line'>  <span class="n">first_value</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="n">OVER</span> <span class="n">w</span> <span class="k">AS</span> <span class="n">first_moved</span><span class="p">,</span>
</span><span class='line'>  <span class="n">last_value</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>  <span class="n">OVER</span> <span class="n">w</span> <span class="k">AS</span> <span class="n">last_moved</span><span class="p">,</span>
</span><span class='line'>  <span class="n">lag</span><span class="p">(</span><span class="n">id</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span><span class="k">ORDER</span> <span class="k">BY</span> <span class="n">id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">prev_id</span><span class="p">,</span>
</span><span class='line'>  <span class="n">lead</span><span class="p">(</span><span class="n">id</span><span class="p">)</span> <span class="n">OVER</span> <span class="p">(</span><span class="k">ORDER</span> <span class="k">BY</span> <span class="n">id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">next_id</span>
</span><span class='line'><span class="k">FROM</span> <span class="n">sample_moves</span>
</span><span class='line'><span class="n">WINDOW</span> <span class="n">w</span> <span class="k">AS</span> <span class="p">(</span>
</span><span class='line'>  <span class="n">PARTITION</span> <span class="k">BY</span> <span class="n">address</span>
</span><span class='line'>  <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">moved_at</span>
</span><span class='line'>  <span class="n">RANGE</span> <span class="k">BETWEEN</span> <span class="n">UNBOUNDED</span> <span class="n">PRECEDING</span> <span class="k">AND</span> <span class="n">UNBOUNDED</span> <span class="n">FOLLOWING</span>
</span><span class='line'><span class="p">)</span>
</span><span class='line'><span class="k">ORDER</span> <span class="k">BY</span> <span class="n">address</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>Results</h4>

<table>
<thead>
<tr>
<th></th>
<th>  id </th>
<th>  name   </th>
<th>  address  </th>
<th>  moved_at  </th>
<th> others </th>
<th> first_moved </th>
<th> last_moved </th>
<th> prev_id </th>
<th> next_id</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>   1 </td>
<td> Alice   </td>
<td> 1 Main St </td>
<td> 2017-01-01 </td>
<td>      0 </td>
<td> Alice       </td>
<td> Alice      </td>
<td>         </td>
<td>       2</td>
</tr>
<tr>
<td></td>
<td>   2 </td>
<td> Bob     </td>
<td> 2 Main St </td>
<td> 2017-02-01 </td>
<td>      1 </td>
<td> Bob         </td>
<td> Cat        </td>
<td>       1 </td>
<td>       3</td>
</tr>
<tr>
<td></td>
<td>   3 </td>
<td> Cat     </td>
<td> 2 Main St </td>
<td> 2017-03-01 </td>
<td>      1 </td>
<td> Bob         </td>
<td> Cat        </td>
<td>       2 </td>
<td>       4</td>
</tr>
<tr>
<td></td>
<td>   4 </td>
<td> Dan Sr  </td>
<td> 3 Main St </td>
<td> 1970-04-01 </td>
<td>      2 </td>
<td> Dan Sr      </td>
<td> Dan 3rd    </td>
<td>       3 </td>
<td>       5</td>
</tr>
<tr>
<td></td>
<td>   5 </td>
<td> Dan Jr  </td>
<td> 3 Main St </td>
<td> 2001-04-01 </td>
<td>      2 </td>
<td> Dan Sr      </td>
<td> Dan 3rd    </td>
<td>       4 </td>
<td>       6</td>
</tr>
<tr>
<td></td>
<td>   6 </td>
<td> Dan 3rd </td>
<td> 3 Main St </td>
<td> 2017-04-01 </td>
<td>      2 </td>
<td> Dan Sr      </td>
<td> Dan 3rd    </td>
<td>       5 </td>
<td></td>
</tr>
</tbody>
</table>


<h1>List Window Functions</h1>

<p>Here is a list from <a href="https://www.postgresql.org/docs/9.3/static/functions-window.html">Postgres docs</a>
of all the window functions. In addition to these, <em>any regular aggregate function</em> can be use within a window.</p>

<table>
<thead>
<tr>
<th></th>
<th> Function        </th>
<th> Description </th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td> row_number()    </td>
<td> number of the current row within its partition, counting from 1 </td>
</tr>
<tr>
<td></td>
<td> rank()          </td>
<td> rank of the current row with gaps; same as row_number of its first peer </td>
</tr>
<tr>
<td></td>
<td> dense_rank()    </td>
<td> rank of the current row without gaps; this function counts peer groups </td>
</tr>
<tr>
<td></td>
<td> percent_rank()  </td>
<td> relative rank of the current row: (rank - 1) / (total rows &ndash; 1) </td>
</tr>
<tr>
<td></td>
<td> cume_dist()     </td>
<td> relative rank of the current row: (number of rows preceding or peer with current row) / (total rows) </td>
</tr>
<tr>
<td></td>
<td> ntile           </td>
<td> integer ranging from 1 to the argument value, dividing the partition as equally as possible </td>
</tr>
<tr>
<td></td>
<td> lag()           </td>
<td> returns value evaluated at the row that is offset rows before the current row within the partition; if there is no such row, instead return default (which must be of the same type as value). Both offset and default are evaluated with respect to the current row. If omitted, offset defaults to 1 and default to null </td>
</tr>
<tr>
<td></td>
<td> lead()          </td>
<td> returns value evaluated at the row that is offset rows after the current row within the partition; if there is no such row, instead return default (which must be of the same type as value). Both offset and default are evaluated with respect to the current row. If omitted, offset defaults to 1 and default to null </td>
</tr>
<tr>
<td></td>
<td> first_value()   </td>
<td> returns value evaluated at the row that is the first row of the window frame </td>
</tr>
<tr>
<td></td>
<td> last_value()    </td>
<td> returns value evaluated at the row that is the last row of the window frame </td>
</tr>
<tr>
<td></td>
<td> nth_value()     </td>
<td> returns value evaluated at the row that is the nth row of the window frame (counting from 1); null if no such row </td>
</tr>
</tbody>
</table>


<h1>References</h1>

<ul>
<li>Postgres Window Tutorial: <a href="https://www.postgresql.org/docs/9.3/static/tutorial-window.html">https://www.postgresql.org/docs/9.3/static/tutorial-window.html</a></li>
<li>Postgres Window Functions: <a href="https://www.postgresql.org/docs/9.3/static/functions-window.html">https://www.postgresql.org/docs/9.3/static/functions-window.html</a></li>
<li>Postgres Window Syntax: <a href="https://www.postgresql.org/docs/9.3/static/sql-expressions.html#SYNTAX-WINDOW-FUNCTIONS">https://www.postgresql.org/docs/9.3/static/sql-expressions.html#SYNTAX-WINDOW-FUNCTIONS</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[What the SQL?!? Recursive]]></title>
    <link href="http://ddrscott.github.io/blog/2017/what-the-sql-recursive/"/>
    <updated>2017-03-15T13:30:00-05:00</updated>
    <id>http://ddrscott.github.io/blog/2017/what-the-sql-recursive</id>
    <content type="html"><![CDATA[<p><img class="featured" src="http://ddrscott.github.io/images/i_heart_recursion.png" width="1804" height="1195" title="'What the SQL?!? Recursive'" ></p>

<p>Today&rsquo;s &ldquo;What the SQL?!?&rdquo; features the keyword <code>RECURSIVE</code>. This clause allows
us to elegantly select results from the previous results from the previous results
from the previous results&hellip;</p>

<!-- more -->


<p>Please note, our target database is PostgreSQL. These examples may work with
other databases, but might need some massaging to get them to work properly.
Search online for the specific vendor&rsquo;s documentation if errors pop up.
Try searching for &ldquo;RECURSIVE queries &rdquo;. Not all database vendors
support the keyword <code>RECURSIVE</code>.</p>

<h2>Fibonacci Sequence</h2>

<p>According to <a href="https://en.wikipedia.org/wiki/Fibonacci_number">Wikipedia</a>:</p>

<blockquote><p>In mathematics, the Fibonacci numbers are the numbers in the following integer
sequence, called the Fibonacci sequence, and characterized by the fact that
every number after the first two is the sum of the two preceding ones:</p>

<pre><code>1, 1, 2, 3, 5, 8, 13, 21, 34, 55 ...
</code></pre></blockquote>

<h2>SQL Solution</h2>

<p>Our SQL solution will make use of the <code>RECURSIVE</code> <a href="https://www.postgresql.org/docs/9.3/static/queries-with.html">CTE</a>
keyword.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">WITH</span> <span class="k">RECURSIVE</span> <span class="n">t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">fi</span><span class="p">,</span> <span class="n">fib</span><span class="p">)</span> <span class="k">AS</span> <span class="p">(</span>
</span><span class='line'>  <span class="k">SELECT</span>
</span><span class='line'>    <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>    <span class="mi">0</span><span class="p">::</span><span class="nb">NUMERIC</span><span class="p">,</span>
</span><span class='line'>    <span class="mi">1</span><span class="p">::</span><span class="nb">NUMERIC</span>
</span><span class='line'>  <span class="k">UNION</span> <span class="k">ALL</span>
</span><span class='line'>  <span class="k">SELECT</span>
</span><span class='line'>    <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span><span class='line'>    <span class="n">fib</span><span class="p">,</span>
</span><span class='line'>    <span class="n">fi</span> <span class="o">+</span> <span class="n">fib</span>
</span><span class='line'>  <span class="k">FROM</span> <span class="n">t</span>
</span><span class='line'>  <span class="k">WHERE</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span>
</span><span class='line'><span class="p">)</span>
</span><span class='line'><span class="k">SELECT</span>
</span><span class='line'>  <span class="n">i</span><span class="p">,</span>
</span><span class='line'>  <span class="n">fib</span>
</span><span class='line'><span class="k">FROM</span> <span class="n">t</span>
</span></code></pre></td></tr></table></div></figure>


<h2>The Ins and Outs</h2>

<p>Here&rsquo;s some inline colorful comments to explain the sections:
<img class="featured" src="http://ddrscott.github.io/images/recursion_sql.png" width="1563" height="998" title="'annotated SQL'" ></p>

<p>Maybe arrows will help a little more with the flow of data:
<img class="featured" src="http://ddrscott.github.io/images/recursive_query.jpg" width="1024" height="705" title="'Data Flow'" ></p>

<h2>Fibonacci Results</h2>

<p>When you run the query, you&rsquo;ll get the following results:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'> <span class="n">i</span>  <span class="o">|</span> <span class="n">fib</span>
</span><span class='line'><span class="c1">----+-----</span>
</span><span class='line'>  <span class="mi">1</span> <span class="o">|</span>   <span class="mi">1</span>
</span><span class='line'>  <span class="mi">2</span> <span class="o">|</span>   <span class="mi">1</span>
</span><span class='line'>  <span class="mi">3</span> <span class="o">|</span>   <span class="mi">2</span>
</span><span class='line'>  <span class="mi">4</span> <span class="o">|</span>   <span class="mi">3</span>
</span><span class='line'>  <span class="mi">5</span> <span class="o">|</span>   <span class="mi">5</span>
</span><span class='line'>  <span class="mi">6</span> <span class="o">|</span>   <span class="mi">8</span>
</span><span class='line'>  <span class="mi">7</span> <span class="o">|</span>  <span class="mi">13</span>
</span><span class='line'>  <span class="mi">8</span> <span class="o">|</span>  <span class="mi">21</span>
</span><span class='line'>  <span class="mi">9</span> <span class="o">|</span>  <span class="mi">34</span>
</span><span class='line'> <span class="mi">10</span> <span class="o">|</span>  <span class="mi">55</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="mi">10</span> <span class="k">rows</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you want to see the results for a high number, update <code>i &lt; 10</code> to a higher
value. If you go above <code>i &lt; 793</code>, Postgres gives up and returns <code>Nan</code> which means
<code>Not a number</code> which means the computed value is larger than your computer can
handle and still treat like a number. Sorry, get a new computer or work with
numbers less than 166 digits long.</p>

<h1>A Real World Example with Hierarchical Data</h1>

<p>Fibonacci sequence is nice and all, but you have real data concerns. You&rsquo;re
thinking, &ldquo;Show me the DATA!&rdquo;. So here&rsquo;s the data&hellip;</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="c1">-- Build `sample_people` table</span>
</span><span class='line'><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">sample_people</span> <span class="k">AS</span>
</span><span class='line'>  <span class="k">SELECT</span>
</span><span class='line'>    <span class="n">column1</span><span class="p">::</span><span class="nb">int</span>     <span class="k">AS</span> <span class="n">id</span><span class="p">,</span>
</span><span class='line'>    <span class="n">column2</span><span class="p">::</span><span class="nb">varchar</span> <span class="k">AS</span> <span class="n">name</span><span class="p">,</span>
</span><span class='line'>    <span class="n">column3</span><span class="p">::</span><span class="nb">int</span>     <span class="k">AS</span> <span class="n">parent_id</span>
</span><span class='line'>  <span class="k">FROM</span> <span class="p">(</span>
</span><span class='line'>    <span class="k">VALUES</span>
</span><span class='line'>      <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Root&#39;</span> <span class="p">,</span> <span class="k">null</span><span class="p">),</span>
</span><span class='line'>      <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span class='line'>      <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
</span><span class='line'>      <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Cat&#39;</span>  <span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
</span><span class='line'>      <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;Dan&#39;</span>  <span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
</span><span class='line'>      <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;Evan&#39;</span> <span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span class='line'>      <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;Frank&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</span><span class='line'>  <span class="p">)</span> <span class="k">as</span> <span class="n">t</span>
</span><span class='line'>  <span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">sample_people</span><span class="p">;</span>
</span><span class='line'><span class="c1">--  id | name  | parent_id</span>
</span><span class='line'><span class="c1">-- ----+-------+-----------</span>
</span><span class='line'><span class="c1">--   0 | Root  |</span>
</span><span class='line'><span class="c1">--   1 | Alice |         0</span>
</span><span class='line'><span class="c1">--   2 | Bob   |         1</span>
</span><span class='line'><span class="c1">--   3 | Cat   |         1</span>
</span><span class='line'><span class="c1">--   4 | Dan   |         3</span>
</span><span class='line'><span class="c1">--   5 | Evan  |         0</span>
</span><span class='line'><span class="c1">--   6 | Frank |         5</span>
</span></code></pre></td></tr></table></div></figure>


<p>Our <code>sample_people</code> table represents a person by name and that person may have a
parent. The parent of all the parents is <code>Root</code>.</p>

<p>And finally our recursive query to get a nice display of the hierarchy.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">WITH</span> <span class="k">RECURSIVE</span> <span class="n">tree</span> <span class="c1">-- `tree` is the table alias.</span>
</span><span class='line'>                    <span class="c1">-- It must be used as part of the `UNION` statement.</span>
</span><span class='line'>  <span class="k">AS</span> <span class="p">(</span>
</span><span class='line'>  <span class="c1">-- 1) Initialize table with all the top level rows.</span>
</span><span class='line'>  <span class="c1">--    Anything without a parent is a parent. Is that apparent?</span>
</span><span class='line'>  <span class="k">SELECT</span>
</span><span class='line'>    <span class="mi">0</span> <span class="k">AS</span> <span class="k">level</span><span class="p">,</span>        <span class="c1">-- 2) Set the level to 0.</span>
</span><span class='line'>    <span class="n">sample_people</span><span class="p">.</span><span class="o">*</span>    <span class="c1">-- 3) Return the initial row</span>
</span><span class='line'>  <span class="k">FROM</span> <span class="n">sample_people</span>
</span><span class='line'>  <span class="k">WHERE</span> <span class="n">parent_id</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1">-- 4) Top level doesn&#39;t have a parent.</span>
</span><span class='line'>  <span class="k">UNION</span> <span class="k">ALL</span>
</span><span class='line'>  <span class="c1">-- 5) Union all the parents with their children.</span>
</span><span class='line'>  <span class="k">SELECT</span>
</span><span class='line'>    <span class="n">tree</span><span class="p">.</span><span class="k">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>    <span class="c1">-- 6) Increment the level every time we loop.</span>
</span><span class='line'>    <span class="n">sample_people</span><span class="p">.</span><span class="o">*</span>    <span class="c1">-- 7) Return the current row - the child row. </span>
</span><span class='line'>  <span class="k">FROM</span> <span class="n">tree</span>    <span class="c1">-- 8) `tree` is populated with the previous results.</span>
</span><span class='line'>               <span class="c1">--    Every loop gets a new record from current result.</span>
</span><span class='line'>  <span class="k">JOIN</span> <span class="n">sample_people</span> <span class="k">ON</span> <span class="n">sample_people</span><span class="p">.</span><span class="n">parent_id</span> <span class="o">=</span> <span class="n">tree</span><span class="p">.</span><span class="n">id</span>
</span><span class='line'><span class="p">)</span>
</span><span class='line'><span class="k">SELECT</span>
</span><span class='line'>  <span class="n">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="k">level</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="o">||</span> <span class="n">name</span> <span class="k">AS</span> <span class="n">display</span>
</span><span class='line'><span class="k">FROM</span> <span class="n">tree</span>
</span><span class='line'><span class="k">ORDER</span> <span class="k">BY</span> <span class="k">level</span><span class="p">,</span> <span class="n">name</span>
</span><span class='line'><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">--    display</span>
</span><span class='line'><span class="c1">-- -------------</span>
</span><span class='line'><span class="c1">--  Alice</span>
</span><span class='line'><span class="c1">--  Evan</span>
</span><span class='line'><span class="c1">--      Bob</span>
</span><span class='line'><span class="c1">--      Cat</span>
</span><span class='line'><span class="c1">--      Frank</span>
</span><span class='line'><span class="c1">--          Dan</span>
</span><span class='line'><span class="c1">-- (6 rows)</span>
</span></code></pre></td></tr></table></div></figure>


<h1>Bait and Switch</h1>

<p><code>RECURSIVE</code> is not actually recursive. It isn&rsquo;t a function calling itself.
Sorry, not sorry. It&rsquo;s much closer to a <code>while</code> loop. Here&rsquo;s what Postgres has to say about it:</p>

<blockquote><p>Note: Strictly speaking, this process is <strong>iteration</strong> not recursion, but RECURSIVE
is the terminology chosen by the SQL standards committee. [emphasis added]</p></blockquote>

<h1>Closing</h1>

<p>So the next time you try to crawl a hierarchy of data, we hope <code>RECURSIVE</code> comes
to mind. It&rsquo;s a great way to save round trips to the database and query what is
needed based on the data&rsquo;s structure. Think of all the nested subqueries we can
save together!</p>

<h1>References</h1>

<ul>
<li>Postgres WITH Queries: <a href="https://www.postgresql.org/docs/9.3/static/queries-with.html">https://www.postgresql.org/docs/9.3/static/queries-with.html</a></li>
<li>Wikipedia Fibonacci number: <a href="https://en.wikipedia.org/wiki/Fibonacci_number">https://en.wikipedia.org/wiki/Fibonacci_number</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[What the SQL?!? Lateral Joins]]></title>
    <link href="http://ddrscott.github.io/blog/2017/what-the-sql-lateral/"/>
    <updated>2017-03-08T12:30:00-06:00</updated>
    <id>http://ddrscott.github.io/blog/2017/what-the-sql-lateral</id>
    <content type="html"><![CDATA[<p><img class="featured" src="http://ddrscott.github.io/images/what_the_sql_lateral.png" title="'What the SQL?!? Lateral Joins'" ></p>

<p>Today&rsquo;s &ldquo;What the SQL?!?&rdquo; features the keyword <code>LATERAL</code>. A prerequisite to
understanding lateral joins are regular joins and subqueries. I&rsquo;ll explain those
briefly to see how <code>LATERAL</code> can simplify a complicated SQL query.</p>

<!-- more -->


<p>Please note, our target database is PostgreSQL. These examples may work with
other databases, but might need some massaging to get them to work properly.
Search online for the specific vendor&rsquo;s documentation if errors pop up.
Try searching for &ldquo;lateral joins &rdquo;. Not all database vendors
support the keyword <code>LATERAL</code>.</p>

<h2>A Problem to Solve</h2>

<p>We have a table with system uptimes. The table records a start timestamp and an
end timestamp. If the service is still running, the end timestamp is left null
because it hasn&rsquo;t ended. We want a query to display an overview this data.</p>

<p>Our final solution will return a row per day and 24 columns containing an uptime
percentage for each hour in the day. It will look like the following.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>  cal_date  | hour_0 | hour_1 | hour_2 | hour_3 | ... | hour_21 | hour_22 | hour_23
</span><span class='line'>------------+--------+--------+--------+--------+-----+---------+---------+---------
</span><span class='line'> 2017-03-01 |      0 |   0.75 |   0.25 |      0 | ... |       0 |       0 |       0
</span><span class='line'> 2017-03-02 |      0 |      0 |      0 |      0 | ... |       1 |       1 |       1
</span><span class='line'>(2 rows)</span></code></pre></td></tr></table></div></figure>


<p>Please note we&rsquo;ll use <code>...</code> abbreviate some of the results. All queries are
schema independent and should be copy/paste-able into any <code>psql</code> session.</p>

<h2>Sample Uptime Data</h2>

<p>The sample uptime data is derived from a virtual table built from the following query:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span>
</span><span class='line'>  <span class="o">*</span>
</span><span class='line'><span class="k">FROM</span> <span class="p">(</span>
</span><span class='line'>  <span class="k">VALUES</span>
</span><span class='line'>  <span class="p">(</span><span class="s1">&#39;2017-03-01 01:15:00-06&#39;</span><span class="p">::</span><span class="k">timestamp</span><span class="p">,</span> <span class="s1">&#39;2017-03-01 02:15:00-06&#39;</span><span class="p">::</span><span class="k">timestamp</span><span class="p">),</span>
</span><span class='line'>  <span class="p">(</span><span class="s1">&#39;2017-03-01 08:00:00-06&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-03-01 20:00:00-06&#39;</span><span class="p">),</span>
</span><span class='line'>  <span class="p">(</span><span class="s1">&#39;2017-03-02 19:00:00-06&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'><span class="p">)</span> <span class="k">AS</span> <span class="n">t</span><span class="p">(</span><span class="n">start_ts</span><span class="p">,</span> <span class="n">end_ts</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>The data looks like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>  start_ts       |       end_ts
</span><span class='line'>---------------------+---------------------
</span><span class='line'> 2017-03-01 01:15:00 | 2017-03-01 02:15:00
</span><span class='line'> 2017-03-01 08:00:00 | 2017-03-01 20:00:00
</span><span class='line'> 2017-03-02 19:00:00 |
</span><span class='line'>(3 rows)</span></code></pre></td></tr></table></div></figure>


<p>We want to plot the time against a time sliced table representing all the
effective hours in the uptime window. We&rsquo;ll make use of another virtual table to
build up all the time slices:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span>
</span><span class='line'>    <span class="n">start_ts</span><span class="p">,</span>
</span><span class='line'>    <span class="n">start_ts</span> <span class="o">+</span> <span class="nb">interval</span> <span class="s1">&#39;1 hour&#39;</span> <span class="k">AS</span> <span class="n">end_ts</span>
</span><span class='line'><span class="k">FROM</span> <span class="n">generate_series</span><span class="p">(</span><span class="s1">&#39;2017-03-01&#39;</span><span class="p">::</span><span class="nb">date</span><span class="p">,</span>
</span><span class='line'>                     <span class="s1">&#39;2017-03-03&#39;</span><span class="p">::</span><span class="k">timestamp</span> <span class="o">-</span> <span class="nb">interval</span> <span class="s1">&#39;1 hour&#39;</span><span class="p">,</span>
</span><span class='line'>                     <span class="nb">interval</span> <span class="s1">&#39;1 hour&#39;</span>
</span><span class='line'>                    <span class="p">)</span> <span class="k">AS</span> <span class="n">t</span><span class="p">(</span><span class="n">start_ts</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>This we make use of PostgreSQL&rsquo;s <a href="https://www.postgresql.org/docs/9.3/static/functions-srf.html">generate_series</a>
to return all the hours between a time range. The data looks like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>  start_ts       |       end_ts
</span><span class='line'>---------------------+---------------------
</span><span class='line'> 2017-03-01 00:00:00 | 2017-03-01 01:00:00
</span><span class='line'> 2017-03-01 01:00:00 | 2017-03-01 02:00:00
</span><span class='line'> 2017-03-01 02:00:00 | 2017-03-01 03:00:00
</span><span class='line'> -- ... many more rows ...
</span><span class='line'> 2017-03-01 03:00:00 | 2017-03-01 04:00:00
</span><span class='line'> 2017-03-02 22:00:00 | 2017-03-02 23:00:00
</span><span class='line'> 2017-03-02 23:00:00 | 2017-03-03 00:00:00
</span><span class='line'>(48 rows)</span></code></pre></td></tr></table></div></figure>


<h2>Left Join</h2>

<p>We use a left join to glue together overlapping time ranges between these two
data sets. We want all the data on the <code>LEFT</code> side in the <code>FROM</code> clause to return
regardless of an uptime record existing within its time slice.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span>
</span><span class='line'>    <span class="o">*</span>
</span><span class='line'><span class="k">FROM</span> <span class="p">(</span>
</span><span class='line'>    <span class="c1">-- build virtual table of all hours between</span>
</span><span class='line'>    <span class="c1">-- a date range</span>
</span><span class='line'>    <span class="k">SELECT</span>
</span><span class='line'>      <span class="n">start_ts</span><span class="p">,</span>
</span><span class='line'>      <span class="n">start_ts</span> <span class="o">+</span> <span class="nb">interval</span> <span class="s1">&#39;1 hour&#39;</span> <span class="k">AS</span> <span class="n">end_ts</span>
</span><span class='line'>    <span class="k">FROM</span> <span class="n">generate_series</span><span class="p">(</span>
</span><span class='line'>           <span class="s1">&#39;2017-03-01&#39;</span><span class="p">::</span><span class="nb">date</span><span class="p">,</span>
</span><span class='line'>           <span class="s1">&#39;2017-03-03&#39;</span><span class="p">::</span><span class="k">timestamp</span> <span class="o">-</span> <span class="nb">interval</span> <span class="s1">&#39;1 hour&#39;</span><span class="p">,</span>
</span><span class='line'>           <span class="nb">interval</span> <span class="s1">&#39;1 hour&#39;</span>
</span><span class='line'>    <span class="p">)</span> <span class="k">AS</span> <span class="n">t</span><span class="p">(</span><span class="n">start_ts</span><span class="p">)</span>
</span><span class='line'><span class="p">)</span> <span class="k">AS</span> <span class="n">cal</span>
</span><span class='line'><span class="k">LEFT</span> <span class="k">JOIN</span> <span class="p">(</span>
</span><span class='line'>    <span class="c1">-- build virtual table of uptimes</span>
</span><span class='line'>    <span class="k">SELECT</span> <span class="o">*</span>
</span><span class='line'>    <span class="k">FROM</span> <span class="p">(</span>
</span><span class='line'>      <span class="k">VALUES</span>
</span><span class='line'>      <span class="p">(</span><span class="s1">&#39;2017-03-01 01:15:00-06&#39;</span><span class="p">::</span><span class="k">timestamp</span><span class="p">,</span> <span class="s1">&#39;2017-03-01 02:15:00-06&#39;</span><span class="p">::</span><span class="k">timestamp</span><span class="p">),</span>
</span><span class='line'>      <span class="p">(</span><span class="s1">&#39;2017-03-01 08:00:00-06&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-03-01 20:00:00-06&#39;</span><span class="p">),</span>
</span><span class='line'>      <span class="p">(</span><span class="s1">&#39;2017-03-02 19:00:00-06&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>    <span class="p">)</span> <span class="k">AS</span> <span class="n">t</span><span class="p">(</span><span class="n">start_ts</span><span class="p">,</span> <span class="n">end_ts</span><span class="p">)</span>
</span><span class='line'><span class="p">)</span> <span class="k">AS</span> <span class="n">uptime</span> <span class="k">ON</span> <span class="n">cal</span><span class="p">.</span><span class="n">end_ts</span> <span class="o">&gt;</span> <span class="n">uptime</span><span class="p">.</span><span class="n">start_ts</span> <span class="k">AND</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span> <span class="o">&lt;=</span> <span class="n">coalesce</span><span class="p">(</span><span class="n">uptime</span><span class="p">.</span><span class="n">end_ts</span><span class="p">,</span> <span class="k">current_timestamp</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>The result set shows we have some variety in our sample data. With 3 slices
up time and 3 slices of downtime.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>  start_ts       |       end_ts        |      start_ts       |       end_ts
</span><span class='line'>---------------------+---------------------+---------------------+---------------------
</span><span class='line'> 2017-03-01 00:00:00 | 2017-03-01 01:00:00 |                     |
</span><span class='line'> 2017-03-01 01:00:00 | 2017-03-01 02:00:00 | 2017-03-01 01:15:00 | 2017-03-01 02:15:00
</span><span class='line'> 2017-03-01 02:00:00 | 2017-03-01 03:00:00 | 2017-03-01 01:15:00 | 2017-03-01 02:15:00
</span><span class='line'> 2017-03-01 03:00:00 | 2017-03-01 04:00:00 |                     |
</span><span class='line'> ...
</span><span class='line'> 2017-03-01 07:00:00 | 2017-03-01 08:00:00 |                     |
</span><span class='line'> 2017-03-01 08:00:00 | 2017-03-01 09:00:00 | 2017-03-01 08:00:00 | 2017-03-01 20:00:00
</span><span class='line'> ...
</span><span class='line'> 2017-03-01 20:00:00 | 2017-03-01 21:00:00 | 2017-03-01 08:00:00 | 2017-03-01 20:00:00
</span><span class='line'> 2017-03-01 21:00:00 | 2017-03-01 22:00:00 |                     |
</span><span class='line'> ...
</span><span class='line'> 2017-03-02 18:00:00 | 2017-03-02 19:00:00 |                     |
</span><span class='line'> 2017-03-02 19:00:00 | 2017-03-02 20:00:00 | 2017-03-02 19:00:00 |
</span><span class='line'> ...
</span><span class='line'> 2017-03-02 23:00:00 | 2017-03-03 00:00:00 | 2017-03-02 19:00:00 |
</span><span class='line'>(48 rows)</span></code></pre></td></tr></table></div></figure>


<p>If we try without the <code>LEFT</code> clause, we&rsquo;ll only see 20 rows containing the up slices.</p>

<h2>Time to compute some timing</h2>

<p>Let&rsquo;s add some times and sensible column names and replace the <code>*</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span>
</span><span class='line'>    <span class="c1">-- will use `first_ts` and `last_ts` to calculate uptime duration</span>
</span><span class='line'>    <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">uptime</span><span class="p">.</span><span class="n">start_ts</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">THEN</span>
</span><span class='line'>        <span class="n">greatest</span><span class="p">(</span><span class="n">uptime</span><span class="p">.</span><span class="n">start_ts</span><span class="p">,</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span><span class="p">)</span>
</span><span class='line'>    <span class="k">END</span>                                               <span class="k">AS</span> <span class="n">first_ts</span><span class="p">,</span>
</span><span class='line'>    <span class="n">least</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">end_ts</span><span class="p">,</span> <span class="n">uptime</span><span class="p">.</span><span class="n">end_ts</span><span class="p">)</span>                  <span class="k">AS</span> <span class="n">last_ts</span><span class="p">,</span>
</span><span class='line'>    <span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span><span class="p">)::</span><span class="nb">date</span>             <span class="k">AS</span> <span class="n">cal_date</span><span class="p">,</span>
</span><span class='line'>    <span class="k">extract</span><span class="p">(</span><span class="n">hour</span> <span class="k">from</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span><span class="p">)</span>                   <span class="k">AS</span> <span class="n">cal_hour</span><span class="p">,</span>
</span><span class='line'>    <span class="k">extract</span><span class="p">(</span><span class="n">epoch</span> <span class="k">from</span> <span class="n">age</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">end_ts</span><span class="p">,</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span><span class="p">))</span> <span class="k">AS</span> <span class="n">cal_seconds</span>
</span><span class='line'><span class="k">FROM</span> <span class="p">(</span>
</span><span class='line'>    <span class="c1">-- build virtual table of all hours between</span>
</span><span class='line'>    <span class="c1">-- a date range</span>
</span><span class='line'>    <span class="k">SELECT</span>
</span><span class='line'>        <span class="n">start_ts</span><span class="p">,</span>
</span><span class='line'>        <span class="n">start_ts</span> <span class="o">+</span> <span class="nb">interval</span> <span class="s1">&#39;1 hour&#39;</span> <span class="k">AS</span> <span class="n">end_ts</span>
</span><span class='line'>        <span class="k">FROM</span> <span class="n">generate_series</span><span class="p">(</span><span class="s1">&#39;2017-03-01&#39;</span><span class="p">::</span><span class="nb">date</span><span class="p">,</span>
</span><span class='line'>                             <span class="s1">&#39;2017-03-03&#39;</span><span class="p">::</span><span class="k">timestamp</span> <span class="o">-</span> <span class="nb">interval</span> <span class="s1">&#39;1 hour&#39;</span><span class="p">,</span>
</span><span class='line'>                             <span class="nb">interval</span> <span class="s1">&#39;1 hour&#39;</span>
</span><span class='line'>        <span class="p">)</span> <span class="k">AS</span> <span class="n">t</span><span class="p">(</span><span class="n">start_ts</span><span class="p">)</span>
</span><span class='line'>    <span class="p">)</span> <span class="k">AS</span> <span class="n">cal</span>
</span><span class='line'><span class="k">LEFT</span> <span class="k">JOIN</span> <span class="p">(</span>
</span><span class='line'>    <span class="c1">-- build virtual table of uptimes</span>
</span><span class='line'>    <span class="k">SELECT</span> <span class="o">*</span>
</span><span class='line'>    <span class="k">FROM</span> <span class="p">(</span>
</span><span class='line'>        <span class="k">VALUES</span>
</span><span class='line'>        <span class="p">(</span><span class="s1">&#39;2017-03-01 01:15:00-06&#39;</span><span class="p">::</span><span class="k">timestamp</span><span class="p">,</span> <span class="s1">&#39;2017-03-01 02:15:00-06&#39;</span><span class="p">::</span><span class="k">timestamp</span><span class="p">),</span>
</span><span class='line'>        <span class="p">(</span><span class="s1">&#39;2017-03-01 08:00:00-06&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-03-01 20:00:00-06&#39;</span><span class="p">),</span>
</span><span class='line'>        <span class="p">(</span><span class="s1">&#39;2017-03-02 19:00:00-06&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>    <span class="p">)</span> <span class="k">AS</span> <span class="n">t</span><span class="p">(</span><span class="n">start_ts</span><span class="p">,</span> <span class="n">end_ts</span><span class="p">)</span>
</span><span class='line'><span class="p">)</span> <span class="k">AS</span> <span class="n">uptime</span> <span class="k">ON</span> <span class="n">cal</span><span class="p">.</span><span class="n">end_ts</span> <span class="o">&gt;</span> <span class="n">uptime</span><span class="p">.</span><span class="n">start_ts</span> <span class="k">AND</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span> <span class="o">&lt;=</span> <span class="n">coalesce</span><span class="p">(</span><span class="n">uptime</span><span class="p">.</span><span class="n">end_ts</span><span class="p">,</span> <span class="k">current_timestamp</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>      first_ts       |       last_ts       |  cal_date  | cal_hour | cal_seconds
</span><span class='line'>---------------------+---------------------+------------+----------+-------------
</span><span class='line'>                     | 2017-03-01 01:00:00 | 2017-03-01 |        0 |        3600
</span><span class='line'> 2017-03-01 01:15:00 | 2017-03-01 02:00:00 | 2017-03-01 |        1 |        3600
</span><span class='line'> 2017-03-01 02:00:00 | 2017-03-01 02:15:00 | 2017-03-01 |        2 |        3600
</span><span class='line'>                     | 2017-03-01 04:00:00 | 2017-03-01 |        3 |        3600
</span><span class='line'>                     | 2017-03-01 05:00:00 | 2017-03-01 |        4 |        3600
</span><span class='line'>                     | 2017-03-01 06:00:00 | 2017-03-01 |        5 |        3600
</span><span class='line'>                     | 2017-03-01 07:00:00 | 2017-03-01 |        6 |        3600
</span><span class='line'>                     | 2017-03-01 08:00:00 | 2017-03-01 |        7 |        3600
</span><span class='line'> 2017-03-01 08:00:00 | 2017-03-01 09:00:00 | 2017-03-01 |        8 |        3600
</span><span class='line'> ...
</span><span class='line'> 2017-03-01 20:00:00 | 2017-03-01 20:00:00 | 2017-03-01 |       20 |        3600
</span><span class='line'>                     | 2017-03-01 22:00:00 | 2017-03-01 |       21 |        3600
</span><span class='line'> ... 
</span><span class='line'>                     | 2017-03-02 19:00:00 | 2017-03-02 |       18 |        3600
</span><span class='line'> 2017-03-02 19:00:00 | 2017-03-02 20:00:00 | 2017-03-02 |       19 |        3600
</span><span class='line'> ...
</span><span class='line'> 2017-03-02 23:00:00 | 2017-03-03 00:00:00 | 2017-03-02 |       23 |        3600
</span><span class='line'>(48 rows)</span></code></pre></td></tr></table></div></figure>


<h2>Subquery, Subquery, What&rsquo;s the Worry?</h2>

<p>SQL is all about nested subqueries. It&rsquo;s hard to escape without creating
views, but who has time to lookup that <a href="https://www.postgresql.org/docs/9.3/static/sql-createview.html">syntax</a>
<em>and</em> get their <a href="https://imgflip.com/i/1kzzyn">DBA&rsquo;s</a> permission to run the DDL?!?</p>

<p>Let&rsquo;s add some duration times to the result set. We&rsquo;ll use the traditional sub
query for it.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span>
</span><span class='line'>    <span class="c1">-- calculate uptime seconds</span>
</span><span class='line'>    <span class="n">coalesce</span><span class="p">(</span>
</span><span class='line'>      <span class="k">extract</span><span class="p">(</span><span class="n">epoch</span> <span class="k">FROM</span> <span class="n">age</span><span class="p">(</span><span class="n">last_ts</span><span class="p">,</span> <span class="n">first_ts</span><span class="p">)),</span>
</span><span class='line'>      <span class="mi">0</span>
</span><span class='line'>    <span class="p">)</span> <span class="k">AS</span> <span class="n">up_seconds</span><span class="p">,</span>
</span><span class='line'>    <span class="o">*</span>
</span><span class='line'><span class="k">FROM</span> <span class="p">(</span>
</span><span class='line'>    <span class="k">SELECT</span>
</span><span class='line'>        <span class="c1">-- will use `first_ts` and `last_ts` to calculate uptime duration</span>
</span><span class='line'>        <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">uptime</span><span class="p">.</span><span class="n">start_ts</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">THEN</span>
</span><span class='line'>            <span class="n">greatest</span><span class="p">(</span><span class="n">uptime</span><span class="p">.</span><span class="n">start_ts</span><span class="p">,</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span><span class="p">)</span>
</span><span class='line'>        <span class="k">END</span>                                               <span class="k">AS</span> <span class="n">first_ts</span><span class="p">,</span>
</span><span class='line'>        <span class="n">least</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">end_ts</span><span class="p">,</span> <span class="n">uptime</span><span class="p">.</span><span class="n">end_ts</span><span class="p">)</span>                  <span class="k">AS</span> <span class="n">last_ts</span><span class="p">,</span>
</span><span class='line'>        <span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span><span class="p">)::</span><span class="nb">date</span>             <span class="k">AS</span> <span class="n">cal_date</span><span class="p">,</span>
</span><span class='line'>        <span class="k">extract</span><span class="p">(</span><span class="n">hour</span> <span class="k">from</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span><span class="p">)</span>                   <span class="k">AS</span> <span class="n">cal_hour</span><span class="p">,</span>
</span><span class='line'>        <span class="k">extract</span><span class="p">(</span><span class="n">epoch</span> <span class="k">from</span> <span class="n">age</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">end_ts</span><span class="p">,</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span><span class="p">))</span> <span class="k">AS</span> <span class="n">cal_seconds</span>
</span><span class='line'>    <span class="k">FROM</span> <span class="p">(</span>
</span><span class='line'>        <span class="c1">-- build virtual table of all hours between</span>
</span><span class='line'>        <span class="c1">-- a date range</span>
</span><span class='line'>        <span class="k">SELECT</span>
</span><span class='line'>            <span class="n">start_ts</span><span class="p">,</span>
</span><span class='line'>            <span class="n">start_ts</span> <span class="o">+</span> <span class="nb">interval</span> <span class="s1">&#39;1 hour&#39;</span> <span class="k">AS</span> <span class="n">end_ts</span>
</span><span class='line'>            <span class="k">FROM</span> <span class="n">generate_series</span><span class="p">(</span><span class="s1">&#39;2017-03-01&#39;</span><span class="p">::</span><span class="nb">date</span><span class="p">,</span>
</span><span class='line'>                                 <span class="s1">&#39;2017-03-03&#39;</span><span class="p">::</span><span class="k">timestamp</span> <span class="o">-</span> <span class="nb">interval</span> <span class="s1">&#39;1 hour&#39;</span><span class="p">,</span>
</span><span class='line'>                                 <span class="nb">interval</span> <span class="s1">&#39;1 hour&#39;</span>
</span><span class='line'>            <span class="p">)</span> <span class="k">AS</span> <span class="n">t</span><span class="p">(</span><span class="n">start_ts</span><span class="p">)</span>
</span><span class='line'>    <span class="p">)</span> <span class="k">AS</span> <span class="n">cal</span>
</span><span class='line'>    <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="p">(</span>
</span><span class='line'>        <span class="c1">-- build virtual table of uptimes</span>
</span><span class='line'>        <span class="k">SELECT</span> <span class="o">*</span>
</span><span class='line'>        <span class="k">FROM</span> <span class="p">(</span>
</span><span class='line'>            <span class="k">VALUES</span>
</span><span class='line'>            <span class="p">(</span><span class="s1">&#39;2017-03-01 01:15:00-06&#39;</span><span class="p">::</span><span class="k">timestamp</span><span class="p">,</span> <span class="s1">&#39;2017-03-01 02:15:00-06&#39;</span><span class="p">::</span><span class="k">timestamp</span><span class="p">),</span>
</span><span class='line'>            <span class="p">(</span><span class="s1">&#39;2017-03-01 08:00:00-06&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-03-01 20:00:00-06&#39;</span><span class="p">),</span>
</span><span class='line'>            <span class="p">(</span><span class="s1">&#39;2017-03-02 19:00:00-06&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>        <span class="p">)</span> <span class="k">AS</span> <span class="n">t</span><span class="p">(</span><span class="n">start_ts</span><span class="p">,</span> <span class="n">end_ts</span><span class="p">)</span>
</span><span class='line'>    <span class="p">)</span> <span class="k">AS</span> <span class="n">uptime</span> <span class="k">ON</span> <span class="n">cal</span><span class="p">.</span><span class="n">end_ts</span> <span class="o">&gt;</span> <span class="n">uptime</span><span class="p">.</span><span class="n">start_ts</span> <span class="k">AND</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span> <span class="o">&lt;=</span> <span class="n">coalesce</span><span class="p">(</span><span class="n">uptime</span><span class="p">.</span><span class="n">end_ts</span><span class="p">,</span> <span class="k">current_timestamp</span><span class="p">)</span>
</span><span class='line'><span class="p">)</span> <span class="n">t1</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> up_seconds
</span><span class='line'>------------
</span><span class='line'>          0
</span><span class='line'>       2700
</span><span class='line'>        900
</span><span class='line'>          0
</span><span class='line'>          0
</span><span class='line'>...
</span><span class='line'>       3600
</span><span class='line'>(48 rows)</span></code></pre></td></tr></table></div></figure>


<p>Without the subquery we&rsquo;d be getting into even more nested function calls and
would have to double compute values or have no visibility in the intermediate
steps. We could have calculated <code>up_seconds</code> directly in the first query which
introduced <code>first_ts</code> and <code>last_ts</code>. That would look like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span>
</span><span class='line'>    <span class="n">coalesce</span><span class="p">(</span>
</span><span class='line'>        <span class="k">extract</span><span class="p">(</span><span class="n">epoch</span> <span class="k">FROM</span>
</span><span class='line'>            <span class="n">age</span><span class="p">(</span>
</span><span class='line'>                <span class="n">least</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">end_ts</span><span class="p">,</span> <span class="n">uptime</span><span class="p">.</span><span class="n">end_ts</span><span class="p">),</span>
</span><span class='line'>                <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">uptime</span><span class="p">.</span><span class="n">start_ts</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">THEN</span>
</span><span class='line'>                  <span class="n">greatest</span><span class="p">(</span><span class="n">uptime</span><span class="p">.</span><span class="n">start_ts</span><span class="p">,</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span><span class="p">)</span>
</span><span class='line'>                <span class="k">END</span>
</span><span class='line'>            <span class="p">)</span>
</span><span class='line'>        <span class="p">),</span>
</span><span class='line'>        <span class="mi">0</span>
</span><span class='line'>    <span class="p">)</span> <span class="k">AS</span> <span class="n">up_seconds</span>
</span><span class='line'><span class="k">FROM</span> <span class="c1">--- ...</span>
</span></code></pre></td></tr></table></div></figure>


<p>It&rsquo;s not for the weak stomach, but frankly speaking, neither is the subquery&hellip;</p>

<h2>Enough Nesting, <code>LATERAL</code> join save me!</h2>

<p>Lateral joins can give us the best of both worlds: reduced subquery nesting and
traceable computed values. We&rsquo;re going to move the initial computed values like
<code>first_ts</code> and <code>last_ts</code>, move them to a virtual table then <code>JOIN LATERAL</code> so
they can get their own table alias. We&rsquo;ll do it again for <code>up_seconds</code> and use
<code>first_ts</code> and <code>last_ts</code> from its sibling table.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span>
</span><span class='line'>    <span class="n">t2</span><span class="p">.</span><span class="n">up_seconds</span>
</span><span class='line'><span class="k">FROM</span> <span class="p">(</span>
</span><span class='line'>    <span class="c1">-- build virtual table of all hours between</span>
</span><span class='line'>    <span class="c1">-- a date range</span>
</span><span class='line'>    <span class="k">SELECT</span>
</span><span class='line'>        <span class="n">start_ts</span><span class="p">,</span>
</span><span class='line'>        <span class="n">start_ts</span> <span class="o">+</span> <span class="nb">interval</span> <span class="s1">&#39;1 hour&#39;</span> <span class="k">AS</span> <span class="n">end_ts</span>
</span><span class='line'>        <span class="k">FROM</span> <span class="n">generate_series</span><span class="p">(</span><span class="s1">&#39;2017-03-01&#39;</span><span class="p">::</span><span class="nb">date</span><span class="p">,</span>
</span><span class='line'>                             <span class="s1">&#39;2017-03-03&#39;</span><span class="p">::</span><span class="k">timestamp</span> <span class="o">-</span> <span class="nb">interval</span> <span class="s1">&#39;1 hour&#39;</span><span class="p">,</span>
</span><span class='line'>                             <span class="nb">interval</span> <span class="s1">&#39;1 hour&#39;</span>
</span><span class='line'>        <span class="p">)</span> <span class="k">AS</span> <span class="n">t</span><span class="p">(</span><span class="n">start_ts</span><span class="p">)</span>
</span><span class='line'>    <span class="p">)</span> <span class="k">AS</span> <span class="n">cal</span>
</span><span class='line'><span class="k">LEFT</span> <span class="k">JOIN</span> <span class="p">(</span>
</span><span class='line'>    <span class="c1">-- build virtual table of uptimes</span>
</span><span class='line'>    <span class="k">SELECT</span> <span class="o">*</span>
</span><span class='line'>    <span class="k">FROM</span> <span class="p">(</span>
</span><span class='line'>        <span class="k">VALUES</span>
</span><span class='line'>        <span class="p">(</span><span class="s1">&#39;2017-03-01 01:15:00-06&#39;</span><span class="p">::</span><span class="k">timestamp</span><span class="p">,</span> <span class="s1">&#39;2017-03-01 02:15:00-06&#39;</span><span class="p">::</span><span class="k">timestamp</span><span class="p">),</span>
</span><span class='line'>        <span class="p">(</span><span class="s1">&#39;2017-03-01 08:00:00-06&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-03-01 20:00:00-06&#39;</span><span class="p">),</span>
</span><span class='line'>        <span class="p">(</span><span class="s1">&#39;2017-03-02 19:00:00-06&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>    <span class="p">)</span> <span class="k">AS</span> <span class="n">t</span><span class="p">(</span><span class="n">start_ts</span><span class="p">,</span> <span class="n">end_ts</span><span class="p">)</span>
</span><span class='line'><span class="p">)</span> <span class="k">AS</span> <span class="n">uptime</span> <span class="k">ON</span> <span class="n">cal</span><span class="p">.</span><span class="n">end_ts</span> <span class="o">&gt;</span> <span class="n">uptime</span><span class="p">.</span><span class="n">start_ts</span> <span class="k">AND</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span> <span class="o">&lt;=</span> <span class="n">coalesce</span><span class="p">(</span><span class="n">uptime</span><span class="p">.</span><span class="n">end_ts</span><span class="p">,</span> <span class="k">current_timestamp</span><span class="p">)</span>
</span><span class='line'><span class="k">JOIN</span> <span class="k">LATERAL</span> <span class="p">(</span>
</span><span class='line'>  <span class="k">SELECT</span>
</span><span class='line'>      <span class="c1">-- will use `first_ts` and `last_ts` to calculate uptime duration</span>
</span><span class='line'>    <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">uptime</span><span class="p">.</span><span class="n">start_ts</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">THEN</span>
</span><span class='line'>        <span class="n">greatest</span><span class="p">(</span><span class="n">uptime</span><span class="p">.</span><span class="n">start_ts</span><span class="p">,</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span><span class="p">)</span>
</span><span class='line'>    <span class="k">END</span>                                               <span class="k">AS</span> <span class="n">first_ts</span><span class="p">,</span>
</span><span class='line'>    <span class="n">least</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">end_ts</span><span class="p">,</span> <span class="n">uptime</span><span class="p">.</span><span class="n">end_ts</span><span class="p">)</span>                  <span class="k">AS</span> <span class="n">last_ts</span><span class="p">,</span>
</span><span class='line'>    <span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span><span class="p">)::</span><span class="nb">date</span>             <span class="k">AS</span> <span class="n">cal_date</span><span class="p">,</span>
</span><span class='line'>    <span class="k">extract</span><span class="p">(</span><span class="n">hour</span> <span class="k">from</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span><span class="p">)</span>                   <span class="k">AS</span> <span class="n">cal_hour</span><span class="p">,</span>
</span><span class='line'>    <span class="k">extract</span><span class="p">(</span><span class="n">epoch</span> <span class="k">from</span> <span class="n">age</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">end_ts</span><span class="p">,</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span><span class="p">))</span> <span class="k">AS</span> <span class="n">cal_seconds</span>
</span><span class='line'><span class="p">)</span> <span class="n">t1</span> <span class="k">ON</span> <span class="k">true</span>
</span><span class='line'><span class="k">JOIN</span> <span class="k">LATERAL</span> <span class="p">(</span>
</span><span class='line'>  <span class="c1">-- calculate uptime seconds for the time slice</span>
</span><span class='line'>  <span class="k">SELECT</span>
</span><span class='line'>    <span class="n">coalesce</span><span class="p">(</span>
</span><span class='line'>        <span class="k">extract</span><span class="p">(</span><span class="n">epoch</span> <span class="k">FROM</span> <span class="n">age</span><span class="p">(</span><span class="n">last_ts</span><span class="p">,</span> <span class="n">first_ts</span><span class="p">)),</span>
</span><span class='line'>        <span class="mi">0</span>
</span><span class='line'>    <span class="p">)</span> <span class="k">AS</span> <span class="n">up_seconds</span>
</span><span class='line'><span class="p">)</span> <span class="n">t2</span> <span class="k">ON</span> <span class="k">true</span>
</span></code></pre></td></tr></table></div></figure>


<p>This gives us the same results but without the deep nesting.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> up_seconds
</span><span class='line'>------------
</span><span class='line'>          0
</span><span class='line'>       2700
</span><span class='line'>        900
</span><span class='line'>          0
</span><span class='line'>          0
</span><span class='line'>       3600
</span><span class='line'>...
</span><span class='line'>       3600
</span><span class='line'>(48 rows)</span></code></pre></td></tr></table></div></figure>


<p>What&rsquo;s great about this strategy is we can quickly choose which columns to see
as we build up the query.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span>
</span><span class='line'>  <span class="n">t2</span><span class="p">.</span><span class="n">up_seconds</span>
</span><span class='line'>  <span class="p">...</span>
</span><span class='line'>
</span><span class='line'><span class="c1">-- or --</span>
</span><span class='line'>
</span><span class='line'><span class="k">SELECT</span>
</span><span class='line'>  <span class="n">t2</span><span class="p">.</span><span class="o">*</span><span class="p">,</span>
</span><span class='line'>  <span class="n">t1</span><span class="p">.</span><span class="o">*</span>
</span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s build up the final calculation using the same strategy:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span>
</span><span class='line'>  <span class="n">t2</span><span class="p">.</span><span class="o">*</span><span class="p">,</span>
</span><span class='line'>  <span class="n">t3</span><span class="p">.</span><span class="o">*</span>
</span><span class='line'><span class="k">FROM</span> <span class="p">...</span>
</span><span class='line'><span class="k">JOIN</span> <span class="k">LATERAL</span> <span class="p">(</span>
</span><span class='line'>  <span class="c1">-- calculate percentage between uptime seconds and available seconds</span>
</span><span class='line'>  <span class="c1">-- within the time slice</span>
</span><span class='line'>  <span class="k">SELECT</span>
</span><span class='line'>    <span class="n">up_seconds</span> <span class="o">/</span> <span class="n">cal_seconds</span> <span class="k">AS</span> <span class="n">up_pct</span>
</span><span class='line'><span class="p">)</span> <span class="n">t3</span> <span class="k">ON</span> <span class="k">true</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> up_seconds | up_pct
</span><span class='line'>------------+--------
</span><span class='line'>          0 |      0
</span><span class='line'>       2700 |   0.75
</span><span class='line'>        900 |   0.25
</span><span class='line'>          0 |      0
</span><span class='line'>...
</span><span class='line'>       3600 |      1
</span><span class='line'>(48 rows)</span></code></pre></td></tr></table></div></figure>


<h2>Plot the Hours</h2>

<p>Now we have all the computed data we need. Let&rsquo;s plot it as a cross tab (but not
actually use <a href="https://www.postgresql.org/docs/9.3/static/tablefunc.html"><code>crosstab</code></a>)</p>

<p>We&rsquo;ll need to consolidate the long list of data by <code>cal_date</code> and pivot the
<code>cal_hour</code> as a column and <code>up_pct</code> as a value. In case of overlapping uptimes
we&rsquo;ll be pessimists and choose the lowest or <code>min</code> uptime percentage.</p>

<p>The final query looks like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span>
</span><span class='line'>    <span class="n">cal_date</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">THEN</span> <span class="n">up_pct</span>  <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_0</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">THEN</span> <span class="n">up_pct</span>  <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_1</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">2</span> <span class="k">THEN</span> <span class="n">up_pct</span>  <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_2</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">3</span> <span class="k">THEN</span> <span class="n">up_pct</span>  <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_3</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">4</span> <span class="k">THEN</span> <span class="n">up_pct</span>  <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_4</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">5</span> <span class="k">THEN</span> <span class="n">up_pct</span>  <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_5</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">6</span> <span class="k">THEN</span> <span class="n">up_pct</span>  <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_6</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">7</span> <span class="k">THEN</span> <span class="n">up_pct</span>  <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_7</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">8</span> <span class="k">THEN</span> <span class="n">up_pct</span>  <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_8</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">9</span> <span class="k">THEN</span> <span class="n">up_pct</span>  <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_9</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">10</span> <span class="k">THEN</span> <span class="n">up_pct</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_10</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">11</span> <span class="k">THEN</span> <span class="n">up_pct</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_11</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">12</span> <span class="k">THEN</span> <span class="n">up_pct</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_12</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">13</span> <span class="k">THEN</span> <span class="n">up_pct</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_13</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">14</span> <span class="k">THEN</span> <span class="n">up_pct</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_14</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">15</span> <span class="k">THEN</span> <span class="n">up_pct</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_15</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">16</span> <span class="k">THEN</span> <span class="n">up_pct</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_16</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">17</span> <span class="k">THEN</span> <span class="n">up_pct</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_17</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">18</span> <span class="k">THEN</span> <span class="n">up_pct</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_18</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">19</span> <span class="k">THEN</span> <span class="n">up_pct</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_19</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">20</span> <span class="k">THEN</span> <span class="n">up_pct</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_20</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">21</span> <span class="k">THEN</span> <span class="n">up_pct</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_21</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">22</span> <span class="k">THEN</span> <span class="n">up_pct</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_22</span><span class="p">,</span>
</span><span class='line'>    <span class="k">max</span><span class="p">(</span><span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">cal_hour</span> <span class="o">=</span> <span class="mi">23</span> <span class="k">THEN</span> <span class="n">up_pct</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> <span class="n">hour_23</span>
</span><span class='line'><span class="k">FROM</span> <span class="p">(</span>
</span><span class='line'>    <span class="c1">-- build virtual table of all hours between</span>
</span><span class='line'>    <span class="c1">-- a date range</span>
</span><span class='line'>    <span class="k">SELECT</span>
</span><span class='line'>        <span class="n">start_ts</span><span class="p">,</span>
</span><span class='line'>        <span class="n">start_ts</span> <span class="o">+</span> <span class="nb">interval</span> <span class="s1">&#39;1 hour&#39;</span> <span class="k">AS</span> <span class="n">end_ts</span>
</span><span class='line'>        <span class="k">FROM</span> <span class="n">generate_series</span><span class="p">(</span><span class="s1">&#39;2017-03-01&#39;</span><span class="p">::</span><span class="nb">date</span><span class="p">,</span>
</span><span class='line'>                             <span class="s1">&#39;2017-03-03&#39;</span><span class="p">::</span><span class="k">timestamp</span> <span class="o">-</span> <span class="nb">interval</span> <span class="s1">&#39;1 hour&#39;</span><span class="p">,</span>
</span><span class='line'>                             <span class="nb">interval</span> <span class="s1">&#39;1 hour&#39;</span>
</span><span class='line'>        <span class="p">)</span> <span class="k">AS</span> <span class="n">t</span><span class="p">(</span><span class="n">start_ts</span><span class="p">)</span>
</span><span class='line'>    <span class="p">)</span> <span class="k">AS</span> <span class="n">cal</span>
</span><span class='line'><span class="k">LEFT</span> <span class="k">JOIN</span> <span class="p">(</span>
</span><span class='line'>    <span class="c1">-- build virtual table of uptimes</span>
</span><span class='line'>    <span class="k">SELECT</span> <span class="o">*</span>
</span><span class='line'>    <span class="k">FROM</span> <span class="p">(</span>
</span><span class='line'>        <span class="k">VALUES</span>
</span><span class='line'>        <span class="p">(</span><span class="s1">&#39;2017-03-01 01:15:00-06&#39;</span><span class="p">::</span><span class="k">timestamp</span><span class="p">,</span> <span class="s1">&#39;2017-03-01 02:15:00-06&#39;</span><span class="p">::</span><span class="k">timestamp</span><span class="p">),</span>
</span><span class='line'>        <span class="p">(</span><span class="s1">&#39;2017-03-01 08:00:00-06&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-03-01 20:00:00-06&#39;</span><span class="p">),</span>
</span><span class='line'>        <span class="p">(</span><span class="s1">&#39;2017-03-02 19:00:00-06&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span>
</span><span class='line'>    <span class="p">)</span> <span class="k">AS</span> <span class="n">t</span><span class="p">(</span><span class="n">start_ts</span><span class="p">,</span> <span class="n">end_ts</span><span class="p">)</span>
</span><span class='line'><span class="p">)</span> <span class="k">AS</span> <span class="n">uptime</span> <span class="k">ON</span> <span class="n">cal</span><span class="p">.</span><span class="n">end_ts</span> <span class="o">&gt;</span> <span class="n">uptime</span><span class="p">.</span><span class="n">start_ts</span> <span class="k">AND</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span> <span class="o">&lt;=</span> <span class="n">coalesce</span><span class="p">(</span><span class="n">uptime</span><span class="p">.</span><span class="n">end_ts</span><span class="p">,</span> <span class="k">current_timestamp</span><span class="p">)</span>
</span><span class='line'><span class="k">JOIN</span> <span class="k">LATERAL</span> <span class="p">(</span>
</span><span class='line'>  <span class="k">SELECT</span>
</span><span class='line'>      <span class="c1">-- will use `first_ts` and `last_ts` to calculate uptime duration</span>
</span><span class='line'>    <span class="k">CASE</span> <span class="k">WHEN</span> <span class="n">uptime</span><span class="p">.</span><span class="n">start_ts</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">THEN</span>
</span><span class='line'>        <span class="n">greatest</span><span class="p">(</span><span class="n">uptime</span><span class="p">.</span><span class="n">start_ts</span><span class="p">,</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span><span class="p">)</span>
</span><span class='line'>    <span class="k">END</span>                                               <span class="k">AS</span> <span class="n">first_ts</span><span class="p">,</span>
</span><span class='line'>    <span class="n">least</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">end_ts</span><span class="p">,</span> <span class="n">uptime</span><span class="p">.</span><span class="n">end_ts</span><span class="p">)</span>                  <span class="k">AS</span> <span class="n">last_ts</span><span class="p">,</span>
</span><span class='line'>    <span class="n">date_trunc</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span><span class="p">)::</span><span class="nb">date</span>             <span class="k">AS</span> <span class="n">cal_date</span><span class="p">,</span>
</span><span class='line'>    <span class="k">extract</span><span class="p">(</span><span class="n">hour</span> <span class="k">from</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span><span class="p">)</span>                   <span class="k">AS</span> <span class="n">cal_hour</span><span class="p">,</span>
</span><span class='line'>    <span class="k">extract</span><span class="p">(</span><span class="n">epoch</span> <span class="k">from</span> <span class="n">age</span><span class="p">(</span><span class="n">cal</span><span class="p">.</span><span class="n">end_ts</span><span class="p">,</span> <span class="n">cal</span><span class="p">.</span><span class="n">start_ts</span><span class="p">))</span> <span class="k">AS</span> <span class="n">cal_seconds</span>
</span><span class='line'><span class="p">)</span> <span class="n">t1</span> <span class="k">ON</span> <span class="k">true</span>
</span><span class='line'><span class="k">JOIN</span> <span class="k">LATERAL</span> <span class="p">(</span>
</span><span class='line'>  <span class="k">SELECT</span>
</span><span class='line'>    <span class="n">coalesce</span><span class="p">(</span>
</span><span class='line'>        <span class="k">extract</span><span class="p">(</span><span class="n">epoch</span> <span class="k">FROM</span> <span class="n">age</span><span class="p">(</span><span class="n">last_ts</span><span class="p">,</span> <span class="n">first_ts</span><span class="p">)),</span>
</span><span class='line'>        <span class="mi">0</span>
</span><span class='line'>    <span class="p">)</span> <span class="k">AS</span> <span class="n">up_seconds</span>
</span><span class='line'><span class="p">)</span> <span class="n">t2</span> <span class="k">ON</span> <span class="k">true</span>
</span><span class='line'><span class="k">JOIN</span> <span class="k">LATERAL</span> <span class="p">(</span>
</span><span class='line'>  <span class="c1">-- calculate percentage between uptime seconds and available seconds</span>
</span><span class='line'>  <span class="c1">-- within the time slice</span>
</span><span class='line'>  <span class="k">SELECT</span>
</span><span class='line'>  <span class="n">up_seconds</span> <span class="o">/</span> <span class="n">cal_seconds</span> <span class="k">AS</span> <span class="n">up_pct</span>
</span><span class='line'><span class="p">)</span> <span class="n">t3</span> <span class="k">ON</span> <span class="k">true</span>
</span><span class='line'><span class="k">GROUP</span> <span class="k">BY</span> <span class="n">cal_date</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>  cal_date  | hour_0 | hour_1 | hour_2 | hour_3 | ... | hour_23
</span><span class='line'>------------+--------+--------+--------+--------+ ... +---------
</span><span class='line'> 2017-03-01 |      0 |   0.75 |   0.25 |      0 | ... |       0
</span><span class='line'> 2017-03-02 |      0 |      0 |      0 |      0 | ... |       1
</span><span class='line'>(2 rows)</span></code></pre></td></tr></table></div></figure>


<h1>More than CTE and Cross Join</h1>

<p>This example only scratches the surface of <code>LATERAL</code>s super powers. On the
surface <code>LATERAL</code> can do things <code>CTE</code>, cross join, and <code>WINDOW</code> can do.
PostgreSQL describe <code>LATERAL</code> as:</p>

<blockquote><p>Subqueries appearing in FROM can be preceded by the key word LATERAL.
This allows them to reference columns provided by preceding FROM items.
(Without LATERAL, each subquery is evaluated independently and so cannot
cross-reference any other FROM item.)</p></blockquote>

<p>TL;DR &ndash; <code>LATERAL</code> allows subqueries to reference earlier tables.</p>

<h1>References</h1>

<ul>
<li><a href="https://www.postgresql.org/docs/9.6/static/queries-table-expressions.html#QUERIES-LATERAL">Postgres Lateral Joins</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to Get Better At Anything]]></title>
    <link href="http://ddrscott.github.io/blog/2017/how-to-get-better-at-anything/"/>
    <updated>2017-02-07T05:30:06-06:00</updated>
    <id>http://ddrscott.github.io/blog/2017/how-to-get-better-at-anything</id>
    <content type="html"><![CDATA[<p><img class="featured" src="http://ddrscott.github.io/images/better.jpg" width="600" height="445" title="'Better Title'" ></p>

<!-- more -->


<h2>RTFM</h2>

<p><img src="http://ddrscott.github.io/images/rtfm-wtfm.jpg" width="400" height="387" title="'RTFM WTFM'" ></p>

<ul>
<li>WTFM, Write The Flip&#8217;n Manual</li>
<li>Do a lightning talk about it :)</li>
</ul>


<h2>Make it Fun</h2>

<p><img src="http://ddrscott.github.io/images/koala_trophy.jpg" title="'Surprised Koala Trophy'" ></p>

<ul>
<li>Gamification</li>
<li>Trophy anyone?</li>
<li>If it can&rsquo;t be made fun, make it fun.</li>
</ul>


<h2>Practice</h2>

<p><img src="http://ddrscott.github.io/images/ive_practiced.jpg" title="&#34;I've practiced a lot&#34;" alt="&#34;I've practiced a lot&#34;"></p>

<ul>
<li>Slowly with intent</li>
<li>Pressure cycles: none, some, actual, intolerable.</li>
<li>The practice of practice deserves its own talk.</li>
</ul>


<h2>Better not good</h2>

<p><img src="http://ddrscott.github.io/images/good_to_better.jpg" title="&#34;Good to Better Chart&#34;" alt="&#34;Good to Better Chart&#34;"></p>

<ul>
<li>Good is the killer of better.</li>
<li>People tend to stop because good is unreachable.</li>
<li>People tend to stop after they&rsquo;re good enough.</li>
<li>If we aim to get better, we&rsquo;ll eventually be better than good.</li>
<li>Progressive goals. OMG! I forgot goal setting!</li>
</ul>


<h2>Learn, don&rsquo;t Memorize</h2>

<p><img src="http://ddrscott.github.io/images/one_does_not_memorize_pi.jpg" title="&#34;One does not simply memorize PI&#34;" alt="&#34;One does not simply memorize PI&#34;"></p>

<ul>
<li>Learning is understanding</li>
<li>Understanding is connecting the new thing to an old thing.</li>
<li>Computers memorize. You&rsquo;re not a computer.</li>
</ul>


<h2>Learn with others</h2>

<p><img src="http://ddrscott.github.io/images/google_hug.jpg" title="&#34;Google Hug&#34;" alt="&#34;Google Hug&#34;"></p>

<ul>
<li>With the Internet you&rsquo;re never alone and always alone.</li>
<li>Actually talk with people!</li>
</ul>


<h2>Cheat</h2>

<p><img src="http://ddrscott.github.io/images/inspect_source.jpg" title="&#34;One does not simply memorize PI&#34;" alt="&#34;One does not simply memorize PI&#34;"></p>

<ul>
<li>If you&rsquo;re not cheating, you&rsquo;re not trying.</li>
<li>Reverse engineer the cheat, don&rsquo;t actually cheat!</li>
</ul>


<h1>How I got better at Vim</h1>

<ul>
<li><strong>RTFM</strong> &ndash; <code>:help</code></li>
<li><strong>WTFM</strong> &ndash; Blogging, figure out other people&rsquo;s problems :/</li>
<li><strong>Practice</strong> &ndash; Wrote stuff that wasn&rsquo;t needed immediately, my own notes.</li>
<li><strong>Don&rsquo;t Memorize</strong> &ndash; Vim has grammar like English. Oooh&hellip; Reconnection!</li>
<li><strong>Learn with Others</strong> &ndash; We have vim users, teach them (but don&rsquo;t let them know you&rsquo;re only one step ahead)</li>
<li><strong>Cheat</strong> &ndash; Look at other&rsquo;s Vimscript to figure out that cool thing they did.</li>
</ul>


<h2>What do you want to get better at next?!?</h2>

<ul>
<li>lightning talks?</li>
<li>Shuffling cards? (@devin)</li>
<li><a href="http://www.postgresql.org/docs/9.6/static/index.html">SQL?</a></li>
<li><a href="https://www.amazon.com/Drawing-Right-Side-Brain-Definitive/dp/1585429201">Drawing?</a></li>
<li><a href="http://www.pianofundamentals.com/book/en/chapter_1">Piano?</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ANSI Codes with Character]]></title>
    <link href="http://ddrscott.github.io/blog/2016/ansi-codes-with-character/"/>
    <updated>2016-07-26T11:11:51-05:00</updated>
    <id>http://ddrscott.github.io/blog/2016/ansi-codes-with-character</id>
    <content type="html"><![CDATA[<p>This was a lightening talk given to the office about ANSI Escape Codes. Most of
the time, all 5 minutes of it, was spent explaining the code snippets.</p>

<!-- more -->


<p><a href="https://en.wikipedia.org/wiki/ANSI_escape_code">Wiki about ANSI Codes</a></p>

<h2>What is an ANSI code?</h2>

<p>ANSI Escape Codes are a nearly universal means of embedding display options in
computer terminals.</p>

<p><code>\e[</code> is how to tell the terminal we&rsquo;re giving it a command instead just
outputting text.</p>

<p>What does that mean?!? Let the examples do the talking.</p>

<h2>Color Examples</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">echo</span> -e <span class="s2">&quot;\e[2J\e[32m It&#39;s not easy being green \e[0m&quot;</span>
</span><span class='line'><span class="nb">echo</span> -e <span class="s2">&quot;\e[2J\e[31m Apples are red  \e[0m&quot;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="p">(</span><span class="mi">30</span><span class="o">.</span><span class="n">.</span><span class="mi">37</span><span class="p">)</span><span class="o">.</span><span class="n">each</span><span class="p">{</span><span class="o">|</span><span class="n">i</span><span class="o">|</span> <span class="nb">puts</span> <span class="s2">&quot;i: </span><span class="se">\e</span><span class="s2">[</span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="s2">m </span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="s2"> </span><span class="se">\e</span><span class="s2">[0m&quot;</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Position Examples</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">x</span><span class="o">=</span><span class="sb">`tput cols`</span><span class="o">.</span><span class="n">to_i</span>
</span><span class='line'><span class="n">y</span><span class="o">=</span><span class="sb">`tput lines`</span><span class="o">.</span><span class="n">to_i</span>
</span><span class='line'><span class="kp">loop</span> <span class="k">do</span>
</span><span class='line'>  <span class="nb">print</span> <span class="s2">&quot;</span><span class="se">\e</span><span class="s2">[s&quot;</span> <span class="c1"># Save current cursor position</span>
</span><span class='line'>  <span class="nb">print</span> <span class="s2">&quot;</span><span class="se">\e</span><span class="s2">[</span><span class="si">#{</span><span class="nb">rand</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">;</span><span class="si">#{</span><span class="nb">rand</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">H&quot;</span>  <span class="c1"># move to row/column</span>
</span><span class='line'>  <span class="nb">print</span> <span class="s2">&quot;💩&quot;</span>    <span class="c1"># print POOP!</span>
</span><span class='line'>  <span class="nb">print</span> <span class="s2">&quot;</span><span class="se">\e</span><span class="s2">[u&quot;</span> <span class="c1"># restore position</span>
</span><span class='line'>  <span class="nb">sleep</span><span class="p">(</span><span class="nb">rand</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># Ruby oneliner troll</span>
</span><span class='line'>ruby -e <span class="s1">&#39;x=`tput cols`.to_i; y=`tput lines`.to_i; loop {print &quot;\e[s\e[#{rand(y)};#{rand(x)}H💩\e[u&quot;; sleep(rand)}&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>ANSI-nine Examples</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># Poop-field</span>
</span><span class='line'>curl -s https://raw.githubusercontent.com/ddrscott/ansinine/master/stars <span class="p">|</span> ruby
</span><span class='line'>
</span><span class='line'><span class="c"># Smoke</span>
</span><span class='line'>curl -s https://raw.githubusercontent.com/ddrscott/ansinine/master/fire.rb <span class="p">|</span> ruby
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Photography Refactored]]></title>
    <link href="http://ddrscott.github.io/blog/2016/photography-lightening-talk/"/>
    <updated>2016-07-11T09:00:00-05:00</updated>
    <id>http://ddrscott.github.io/blog/2016/photography-lightening-talk</id>
    <content type="html"><![CDATA[<p><img class="featured" src="http://ddrscott.github.io/images/photography-lightening-talk.png" width="527" height="494" title="'Photography Lightening Talk'" ></p>

<p>Someone convinced me to do a lightening talk about photography. Here&rsquo;s the slide deck.</p>

<!-- more -->


<div class="responsive-wrapper">
<iframe src="https://docs.google.com/presentation/d/1Fc0FhDv9Qhtx1704oKA3qWb3-OFsobk-ppGHU2LKolg/embed?start=false&loop=false&delayms=3000" frameborder="0" width="1440" height="839" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>
</div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PSA: Vim Modulo '%' Returns Negative Numbers!]]></title>
    <link href="http://ddrscott.github.io/blog/2016/negative-modulo/"/>
    <updated>2016-05-28T09:00:00-05:00</updated>
    <id>http://ddrscott.github.io/blog/2016/negative-modulo</id>
    <content type="html"><![CDATA[<p><img class="featured" src="http://ddrscott.github.io/images/einstein_mod.jpg" width="500" height="375" title="'-10 % 3 != -1'" ></p>

<p>Surprise! Vim has the same modulo bug as Javascript. Some say it&rsquo;s not a bug,
but if Ruby and Google Calculator is wrong, I don&rsquo;t want to be right.</p>

<!-- more -->


<ul>
<li>Vim, <code>:echo -10 % 3</code> returns <code>-1</code></li>
<li>Javascript <code>-10 % 3</code> returns <code>-1</code></li>
<li>Ruby/IRB, <code>-10 % 3</code> returns <code>2</code> <strong>&mdash; my expectation is here</strong></li>
</ul>


<h2>Solution</h2>

<p>Add this function some where in your Vimscript and throw away <code>%</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="c">&quot; ((n % m) + m) % m` or `((-10 % 3) + 3) % 3` returns `2`</span>
</span><span class='line'><span class="k">function</span><span class="p">!</span> <span class="k">s</span>:<span class="k">mod</span><span class="p">(</span><span class="k">n</span><span class="p">,</span><span class="k">m</span><span class="p">)</span>
</span><span class='line'>  <span class="k">return</span> <span class="p">((</span><span class="k">a</span>:<span class="k">n</span> % <span class="k">a</span>:<span class="k">m</span><span class="p">)</span> <span class="p">+</span> <span class="k">a</span>:<span class="k">m</span><span class="p">)</span> % <span class="k">a</span>:<span class="k">m</span>
</span><span class='line'><span class="k">endfunction</span>
</span></code></pre></td></tr></table></div></figure>


<p>I hope this saves someone some time somewhere out there. It&rsquo;s an hour I&rsquo;ll never
get back, but happy to give back.</p>

<p><strong>References</strong></p>

<ul>
<li><a href="https://www.google.com/#q=-10+%25+3">https://www.google.com/#q=-10+%25+3</a></li>
<li><a href="http://vimdoc.sourceforge.net/htmldoc/eval.html#expr6">http://vimdoc.sourceforge.net/htmldoc/eval.html#expr6</a></li>
<li><a href="http://math.stackexchange.com/questions/519845/modulo-of-a-negative-number/519856">http://math.stackexchange.com/questions/519845/modulo-of-a-negative-number/519856</a></li>
<li><a href="https://en.wikipedia.org/wiki/Modulo_operation">https://en.wikipedia.org/wiki/Modulo_operation</a></li>
<li><a href="http://stackoverflow.com/questions/4467539/javascript-modulo-not-behaving">http://stackoverflow.com/questions/4467539/javascript-modulo-not-behaving</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Vim Side Search: Making Search Fun Again]]></title>
    <link href="http://ddrscott.github.io/blog/2016/side-search/"/>
    <updated>2016-05-27T09:00:00-05:00</updated>
    <id>http://ddrscott.github.io/blog/2016/side-search</id>
    <content type="html"><![CDATA[<p><img class="featured" src="http://ddrscott.github.io/images/vim_ag_unicorn.png" width="699" height="453" title="'Vim + Ag = Unicorn'" ></p>

<p>The <code>quickfix</code> feature is nice, but it doesn&rsquo;t give enough context around the
search term that leads to use <code>ag</code> from terminal and switch back and forth
between programs. I do this search dance every day and I&rsquo;ve had it! There must
be better way!</p>

<!-- more -->


<h2>Problem</h2>

<p><img class="featured" src="http://ddrscott.github.io/images/side-search-a.png" width="1280" height="1009" title="'Quickfix for help'" >
Look at the <code>quickfix</code> window above. It spends most of its space showing the file name
of the hit, then the remainder is spent on text around it. In projects using
<a href="http://guides.rubyonrails.org/engines.html">Rails Engines</a> with deeply nested
directory structures, this often leaves me with just a bunch of paths in the <code>quickfix</code>.</p>

<h2>Solution A &ndash; The Unix Way</h2>

<p>Some may argue Vim isn&rsquo;t suppose to do search. Vim rightly delegates to the
<a href="http://www.catb.org/esr/writings/taoup/html/ch01s06.html">Unix philosophy</a> by
allowing an external program do its searching. Let&rsquo;s try that for this
solution using <code>grep</code>, <code>ack</code>, and <code>ag</code>.</p>

<p><img class="featured" src="http://ddrscott.github.io/images/side-search-compare.png" width="1280" height="822" title="'grep vs ack vs ag'" ></p>

<p>We&rsquo;ve run the 3 separate programs (normally, I would only use <code>ag</code>) then
browse the results to see if there&rsquo;s an interesting file. At this point I start
using my handy-dandy mouse to scroll around, precisely highlight the path of
interest, copy, and type <code>vim &lt;Paste&gt;</code>. Intuitive? Yes. Fast? No!</p>

<p>Maybe I should use <code>tmux</code> or <code>screen</code> so I don&rsquo;t need to mouse around, but
trying to select a path is still pretty slow for me and requires more cognitive
load than I have patience for. After all, I&rsquo;m trying to concentrate on a
refactor or something, not how to open a bunch of files. Should I practice more?
Yes. Will I? No!</p>

<p>We&rsquo;re going to use <code>ag</code> from now on, since it&rsquo;s faster than <code>ack</code>, and has
prettier output than <code>grep</code>. I really really really tried to get <code>grep</code> to
output for humans, but couldn&rsquo;t figure it out.</p>

<h2>Solution B &ndash; Vim without Quickfix</h2>

<p>Let Vim do some work for us.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>vim `ag --ignore=\*.{css,scss} -l help` +'/help'</span></code></pre></td></tr></table></div></figure>


<p>What&rsquo;s that?!? Open Vim passing the result of <code>ag</code> command. <code>ag</code> is run with
some file exclusions, <code>-l</code> only file names, and <code>help</code> is the search term.
<code>+'/help'</code> tells Vim to immediately start searching for &lsquo;help&rsquo;.</p>

<p>After all that, Vim should have started with a bunch of buffers. View them with
<code>:ls</code>. Take notice of the buffer numbers to see how many files were found. Use
<code>n</code> and <code>N</code> to jump through search matches in the file. Use <code>:bn</code> to go to the
next buffer and start hitting <code>n</code> again to cycle through the changes. If the
number of files is small enough, you may be able to use <code>:ball</code> to open every
buffer in its own window.</p>

<p>Thats a lot of work to jump through changes. Good thing the <code>quickfix</code> exists.</p>

<h2>Solution C &ndash; Quickfix</h2>

<p>This is here for posterity. <code>quickfix</code> DOES make cycling through changes easier
than Solution B, but as I stated in the intro, it doesn&rsquo;t give the context that
we want.</p>

<p><a href="https://robots.thoughtbot.com/faster-grepping-in-vim">Thoughtbot has a pretty good article</a>
about how to setup Vim to use <code>ag</code>. Once you do that, you can <code>:grep help</code> to
get the following output:</p>

<p><img class="featured" src="http://ddrscott.github.io/images/side-search-a.png" width="1280" height="1009" title="'Quickfix for help'" ></p>

<p>Use <code>:cnext</code>, <code>:cprev</code>, <code>:cfirst</code>, <code>:clast</code> to go to next, previous, first, and
last <code>quickfix</code> result respectively. Map those to keys to make it easier to
navigate.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nnoremap [q :cprev&lt;CR&gt;
</span><span class='line'>nnoremap ]q :cnext&lt;CR&gt;
</span><span class='line'>nnoremap [Q :cfirst&lt;CR&gt;
</span><span class='line'>nnoremap ]Q :clast&lt;CR&gt;</span></code></pre></td></tr></table></div></figure>


<p>Get more help about <code>quickfix</code> using <code>:help quickfix</code>. Cry after realizing
even <code>:help quickfix</code> can&rsquo;t show more context. I&rsquo;ll be here when you&rsquo;re done.</p>

<h2>Solution D &ndash; Side Search Plugin</h2>

<p>So how do we get the best of both worlds? How do we enter the land of a thousand
wives/husbands? How do we get <code>ag</code> output and quick navigation? For me, it
was writing a plugin in. For you it&rsquo;s using it. <a href="https://github.com/ddrscott/vim-side-search">https://github.com/ddrscott/vim-side-search</a></p>

<p>After installing the plugin using your favorite package manager, you&rsquo;ll have
access to the following functionality:</p>

<p><img class="featured" src="http://ddrscott.github.io/images/side-search-demo-b.gif" width="1169" height="631" title="'Side Search Demo'" ></p>

<p>Things to notice:</p>

<ul>
<li><code>ag</code> output is in a buffer with additional syntax highlighting!</li>
<li><code>n</code> and <code>N</code> used to jump to matches. Regular Vim navigation works, too!</li>
<li><code>&lt;CR&gt;</code> and <code>&lt;C-w&gt;&lt;CR&gt;</code> used to open change and jump to change!</li>
<li>Number of matches shown in the buffer name!</li>
<li>I use too many exclamation points!!!</li>
</ul>


<p>The plugin&rsquo;s <code>README</code> has more details.</p>

<h2>Closing</h2>

<p>I&rsquo;ve been using this plugin ever since its inception and don&rsquo;t know where I&rsquo;d
be without it. It gets some inspiration from <a href="https://github.com/tpope/vim-fugitive">fugitive&rsquo;s</a>
<code>:Gstatus</code> mode/buffer, and I wish there were more plugins that added
functionality from <code>stdout</code> instead of transforming it into a different format. Unix
tools makers spend a lot of time thinking about the output. Let&rsquo;s use it to our
advantage.</p>

<p>I&rsquo;ve learn a lot creating this plugin and plan to write about it in a future post.
Do you love it or hate it? Have more ideas for Side Search? Please let me know what you
think of it. Have more ideas or issues for Side Search? Hit me up on <a href="https://github.com/ddrscott/vim-side-search">Github</a>.</p>

<h3>References</h3>

<ul>
<li><a href="https://github.com/ggreer/the_silver_searcher">The Silver Searcher</a> by Geoff Greer</li>
<li><code>man ag</code></li>
<li><code>man grep</code></li>
<li><code>man tmux</code></li>
<li><code>man screen</code></li>
<li><code>:help quickfix</code></li>
<li><a href="https://robots.thoughtbot.com/faster-grepping-in-vim">Faster Grepping in Vim</a> by Thoughtbot</li>
<li><a href="https://www.google.com/search?q=the+number+12">The number 12</a></li>
</ul>


<h3>In The News</h3>

<ul>
<li><a href="https://news.ycombinator.com/item?id=11787085">Hacker News</a></li>
<li><a href="https://www.reddit.com/r/vim/comments/4lbdur/vim_side_search_plugin_making_search_fun_again/">Reddit</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Sensible Horizontal Scroll in Vim]]></title>
    <link href="http://ddrscott.github.io/blog/2016/sidescroll/"/>
    <updated>2016-05-05T09:00:00-05:00</updated>
    <id>http://ddrscott.github.io/blog/2016/sidescroll</id>
    <content type="html"><![CDATA[<p><img class="featured" src="http://ddrscott.github.io/images/sidescroll-feature.png" width="1280" height="971" title="'I heart sidescroll'" ></p>

<p>Sometimes it&rsquo;s the little things that make a big difference, and this is about
as small as it can get. Occasionally, I hold down <code>l</code>, <code>w</code>, or <code>e</code> to view long
lines which have disappeared off the window. It&rsquo;s a bad habit and the penalty
always ruins my concentration. But after I found this setting, I&rsquo;m free
to cursor around like an innocent child unaware of death.</p>

<!-- more -->


<p><em>TL;DR</em> &mdash; <code>set sidescroll=1</code></p>

<h2>Problem</h2>

<p>When <code>set wrap</code> is off, otherwise known as <code>set nowrap</code>, and a line is longer
than the window can handle, you&rsquo;ll need to scroll to see more of the line.
<code>{x}zl</code> and <code>{x}zh</code> will scroll the screen right and left respectively.
That&rsquo;s a lot to remember to see some more text. Which leads me to hold
down <code>w</code> or <code>e</code> to get it done followed by janky behavior when the
cursor gets to the edge of the window. The default behavior of revealing more
text is &frac12; a window width at a time. This abrupt jump throws off my fragile
concentration.</p>

<p><img class="featured" src="http://ddrscott.github.io/images/sidescroll-off.gif" width="635" height="337" title="'Demo Sidescroll Off'" ></p>

<h2>Solution A</h2>

<p>Turn on word wrapping. <code>set wrap</code>. Boring, but effective. You might also want
to make word wrapping look nicer. I do that with the following settings.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="k">set</span> breakindent
</span><span class='line'><span class="k">set</span> breakindentopt<span class="p">=</span><span class="k">sbr</span>
</span><span class='line'><span class="c">&quot; I use a unicode curly array with a &lt;backslash&gt;&lt;space&gt;</span>
</span><span class='line'><span class="k">set</span> <span class="nb">showbreak</span><span class="p">=</span>↪<span class="p">&gt;</span>\
</span></code></pre></td></tr></table></div></figure>


<p>This of course doesn&rsquo;t solve the problem if, in fact, we want wrapping off.</p>

<h2>Solution B</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="k">set</span> <span class="nb">sidescroll</span><span class="p">=</span><span class="m">1</span>
</span></code></pre></td></tr></table></div></figure>


<p>This simple setting makes Vim behave like every other plain editor. It will
incrementally scroll one character at a time to reveal more text as needed.</p>

<p><img class="featured" src="http://ddrscott.github.io/images/sidescroll-on.gif" width="635" height="337" title="'Demo Sidescroll On'" ></p>

<p>Here&rsquo;s the help doc to clear things up:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>'sidescroll' 'ss'    number  (default 0)
</span><span class='line'>                  global
</span><span class='line'>        The minimal number of columns to scroll horizontally.  Used only when
</span><span class='line'>        the 'wrap' option is off and the cursor is moved off of the screen.
</span><span class='line'>        When it is zero the cursor will be put in the middle of the screen.
</span><span class='line'>        When using a slow terminal set it to a large number or 0.  When using
</span><span class='line'>        a fast terminal use a small number or 1.  Not used for "zh" and "zl"
</span><span class='line'>        commands.
</span><span class='line'>
</span><span class='line'>'sidescrolloff' 'siso'    number (default 0)
</span><span class='line'>global
</span><span class='line'>        The minimal number of screen columns to keep to the left and to the
</span><span class='line'>        right of the cursor if 'nowrap' is set.  Setting this option to a
</span><span class='line'>        value greater than 0 while having |'sidescroll'| also at a non-zero
</span><span class='line'>        value makes some context visible in the line you are scrolling in
</span><span class='line'>        horizontally (except at beginning of the line).  Setting this option
</span><span class='line'>        to a large value (like 999) has the effect of keeping the cursor
</span><span class='line'>        horizontally centered in the window, as long as one does not come too
</span><span class='line'>        close to the beginning of the line.
</span><span class='line'>
</span><span class='line'>        Example: Try this together with 'sidescroll' and 'listchars' as
</span><span class='line'>                 in the following example to never allow the cursor to move
</span><span class='line'>                 onto the "extends" character:
</span><span class='line'>
</span><span class='line'>                 :set nowrap sidescroll=1 listchars=extends:&gt;,precedes:&lt;
</span><span class='line'>                 :set sidescrolloff=1</span></code></pre></td></tr></table></div></figure>


<p>Seems like the default was intended for a &ldquo;slow terminal&rdquo;. If you&rsquo;re using a
slow terminal while editing a large amount of unwrapped text, I&rsquo;d recommend
getting a computer from this millennia and enabling <code>sidescroll</code>.
Also note that a sensible example is shown in the <code>sidescrolloff</code> section.</p>

<h1>Off Topic&hellip;</h1>

<p>It&rsquo;s interesting to study all the decisions made due to slow terminals.
Try <code>:help slow-terminal</code> for a quick look and try <code>:helpgrep slow</code> to see way
more mentions. Use <code>:help helpgrep</code> if you didn&rsquo;t know about <code>helpgrep</code> :)</p>

<h1>Closing</h1>

<p>I&rsquo;m sure you&rsquo;re thinking why so many words were written for a single setting.
Similar to my previous post about <a href="http://ddrscott.github.io/blog/2016/yank-without-jank/">Yank without Jank</a>,
these unexpected janky behaviors cause anxiety. Anxiety that usually can&rsquo;t be
identified or resolved in the heat of a coding session, but is there, wading in
the weeds, ready to pounce at your next stray keystroke. As a student of Vim, I
want identify and resolve these issues so I can get back to why I like Vim;
using the dot operator.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Making a Window Submode in Vim]]></title>
    <link href="http://ddrscott.github.io/blog/2016/making-a-window-submode/"/>
    <updated>2016-04-29T09:00:00-05:00</updated>
    <id>http://ddrscott.github.io/blog/2016/making-a-window-submode</id>
    <content type="html"><![CDATA[<p><img class="featured" src="http://ddrscott.github.io/images/window-mode-feature.png" width="1280" height="380" title="'Header Image'" >
I found a plugin that is changing my Vim-tire life! This
<a href="https://github.com/kana/vim-submode">plugin</a> is so awesome it should be
built into default Vim. What does the <a href="https://github.com/kana/vim-submode">plugin</a>
do? It enables the creation of new submodes. Why would a person want <em>more</em> modes?!?
Isn&rsquo;t dealing with modes the main deterrent for new Vim users? Isn&rsquo;t Normal,
Insert, Command-line, Visual, Select, and Operator-pending enough? (Did I miss one?)
Let&rsquo;s try out a new submode and see what happens.</p>

<!-- more -->


<h2>Problem</h2>

<p>Window commands are prefixed with <code>&lt;C-w&gt;</code>. Want to create a horizontal split?
Try <code>&lt;C-w&gt;s</code>, didn&rsquo;t mean to do that and want to do vertical split? <code>&lt;C-w&gt;q&lt;C-w&gt;v</code>.
Want to resize the vertical split <code>50&lt;C-w&gt;&gt;</code>? Too wide? Narrow it with <code>5&lt;C-w&gt;&lt;</code>.
Move back to the other window? <code>&lt;C-w&gt;p</code> or <code>&lt;C-w&gt;w</code>.</p>

<p>Are your fingers getting tired? After I get the windows just right using default
mappings my fingers are crying for mercy.</p>

<p>Here&rsquo;s a short list of common default window commands:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="c">&quot; Change window focus</span>
</span><span class='line'>{<span class="k">n</span>}<span class="p">&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;</span><span class="k">h</span>   move cursor <span class="k">left</span>  {<span class="k">n</span>} <span class="nb">window</span>
</span><span class='line'>{<span class="k">n</span>}<span class="p">&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;</span><span class="k">l</span>   move cursor <span class="k">right</span> {<span class="k">n</span>} <span class="nb">window</span>
</span><span class='line'>{<span class="k">n</span>}<span class="p">&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;</span><span class="k">j</span>   move cursor down  {<span class="k">n</span>} <span class="nb">window</span>
</span><span class='line'>{<span class="k">n</span>}<span class="p">&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;</span><span class="k">k</span>   move cursor <span class="k">up</span>    {<span class="k">n</span>} <span class="nb">window</span>
</span><span class='line'>
</span><span class='line'><span class="c">&quot; Move window</span>
</span><span class='line'><span class="p">&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;</span>H   move <span class="nb">window</span> far <span class="k">left</span>
</span><span class='line'><span class="p">&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;</span>L   move <span class="nb">window</span> far <span class="k">right</span>
</span><span class='line'><span class="p">&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;</span>J   move <span class="nb">window</span> far bottom
</span><span class='line'><span class="p">&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;</span>K   move <span class="nb">window</span> far <span class="k">top</span>
</span><span class='line'>
</span><span class='line'><span class="c">&quot; Change size</span>
</span><span class='line'>{<span class="k">n</span>}<span class="p">&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;+</span>  increase height by {<span class="k">n</span>} rows
</span><span class='line'>{<span class="k">n</span>}<span class="p">&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;-</span>  decrease height by {<span class="k">n</span>} rows
</span><span class='line'>{<span class="k">n</span>}<span class="p">&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;&lt;</span>  decrease width by {<span class="k">n</span>} <span class="nb">columns</span>
</span><span class='line'>{<span class="k">n</span>}<span class="p">&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;&gt;</span>  increase width by {<span class="k">n</span>} <span class="nb">columns</span>
</span><span class='line'>   <span class="p">&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;|</span>  maximize width
</span><span class='line'>   <span class="p">&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;</span>_  maximize height
</span><span class='line'>   <span class="p">&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;=</span>  equalize sizes
</span></code></pre></td></tr></table></div></figure>


<p>For a comprehensive list of window commands try <code>:help windows.txt</code>.</p>

<h2>Solution A</h2>

<p>The most common solution to window-command-itis is to map other keys to these
common actions so to include the <code>&lt;C-w&gt;</code> prefix.</p>

<p>From <a href="https://github.com/spf13/spf13-vim/blob/3.0/.vimrc">spf13-vim</a>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'>map <span class="p">&lt;</span>C<span class="p">-</span>J<span class="p">&gt;</span> <span class="p">&lt;</span>C<span class="p">-</span>W<span class="p">&gt;</span><span class="k">j</span><span class="p">&lt;</span>C<span class="p">-</span>W<span class="p">&gt;</span>_
</span><span class='line'>map <span class="p">&lt;</span>C<span class="p">-</span>K<span class="p">&gt;</span> <span class="p">&lt;</span>C<span class="p">-</span>W<span class="p">&gt;</span><span class="k">k</span><span class="p">&lt;</span>C<span class="p">-</span>W<span class="p">&gt;</span>_
</span><span class='line'>map <span class="p">&lt;</span>C<span class="p">-</span>L<span class="p">&gt;</span> <span class="p">&lt;</span>C<span class="p">-</span>W<span class="p">&gt;</span><span class="k">l</span><span class="p">&lt;</span>C<span class="p">-</span>W<span class="p">&gt;</span>_
</span><span class='line'>map <span class="p">&lt;</span>C<span class="p">-</span>H<span class="p">&gt;</span> <span class="p">&lt;</span>C<span class="p">-</span>W<span class="p">&gt;</span><span class="k">h</span><span class="p">&lt;</span>C<span class="p">-</span>W<span class="p">&gt;</span>_
</span><span class='line'><span class="c">&quot; Note: They go one extra by maximizing the height after entering the split.</span>
</span></code></pre></td></tr></table></div></figure>


<p>From <a href="https://robots.thoughtbot.com/vim-splits-move-faster-and-more-naturally">Thoughbot</a>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="nb">nnoremap</span> <span class="p">&lt;</span>C<span class="p">-</span>J<span class="p">&gt;</span> <span class="p">&lt;</span>C<span class="p">-</span>W<span class="p">&gt;&lt;</span>C<span class="p">-</span>J<span class="p">&gt;</span>
</span><span class='line'><span class="nb">nnoremap</span> <span class="p">&lt;</span>C<span class="p">-</span>K<span class="p">&gt;</span> <span class="p">&lt;</span>C<span class="p">-</span>W<span class="p">&gt;&lt;</span>C<span class="p">-</span>K<span class="p">&gt;</span>
</span><span class='line'><span class="nb">nnoremap</span> <span class="p">&lt;</span>C<span class="p">-</span>L<span class="p">&gt;</span> <span class="p">&lt;</span>C<span class="p">-</span>W<span class="p">&gt;&lt;</span>C<span class="p">-</span>L<span class="p">&gt;</span>
</span><span class='line'><span class="nb">nnoremap</span> <span class="p">&lt;</span>C<span class="p">-</span>H<span class="p">&gt;</span> <span class="p">&lt;</span>C<span class="p">-</span>W<span class="p">&gt;&lt;</span>C<span class="p">-</span>H<span class="p">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>This has been the accepted solution for most, but it takes away so many
convenient keys. And in some cases, it even overrides default behaviour.
<code>&lt;C-L&gt;</code>, I miss you. <code>C-H</code>, isn&rsquo;t that also <code>&lt;BS&gt;</code>? Guess I won&rsquo;t be using
you either.</p>

<h2>Solution B &ndash; Submode to the Rescue</h2>

<p>This entire solution depends on <a href="https://github.com/kana/vim-submode.git">kana/vim-submode</a>,
I consider it one of Japan&rsquo;s national treasures along with ninjas and ramen.
Unfortunately, Kana&rsquo;s example use of submodes is a little underwhelming:
undo/redo using <code>g-</code> and <code>g+</code>. I agree with the author that using <code>g-</code> and
<code>g+</code> is not convenient, and using <code>g++++-++-+</code> is easier, but the solution
for that was simply <code>u</code> and <code>&lt;C-R&gt;</code>. I feel a better application for a new
submode is window management. Imagine if resizing a split was <code>&lt;C-w&gt;++++++++</code>
or <code>&lt;C-w&gt;------=-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&lt;&gt;</code> or changing cursor location was <code>&lt;C-w&gt;hjlll</code>
or moving was <code>&lt;C-w&gt;HjKLkjh</code>. Imagine no more!</p>

<p>First, install the plugin. If you&rsquo;re not sure how to install a plugin, try
<a href="https://github.com/junegunn/vim-plug">junegunn/vim-plug</a>. Next, add the
following to your <code>$MYVIMRC</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="c">&quot; A message will appear in the message line when you&#39;re in a submode</span>
</span><span class='line'><span class="c">&quot; and stay there until the mode has existed.</span>
</span><span class='line'><span class="k">let</span> <span class="k">g</span>:submode_always_show_submode <span class="p">=</span> <span class="m">1</span>
</span><span class='line'>
</span><span class='line'><span class="c">&quot; We&#39;re taking over the default &lt;C-w&gt; setting. Don&#39;t worry we&#39;ll do</span>
</span><span class='line'><span class="c">&quot; our best to put back the default functionality.</span>
</span><span class='line'><span class="k">call</span> submode#enter_with<span class="p">(</span><span class="s1">&#39;window&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;C-w&gt;&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c">&quot; Note: &lt;C-c&gt; will also get you out to the mode without this mapping.</span>
</span><span class='line'><span class="c">&quot; Note: &lt;C-[&gt; also behaves as &lt;ESC&gt;</span>
</span><span class='line'><span class="k">call</span> submode#leave_with<span class="p">(</span><span class="s1">&#39;window&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;ESC&gt;&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c">&quot; Go through every letter</span>
</span><span class='line'><span class="k">for</span> <span class="nb">key</span> <span class="k">in</span> [<span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="s1">&#39;j&#39;</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">,</span>
</span><span class='line'>\           <span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="s1">&#39;p&#39;</span><span class="p">,</span><span class="s1">&#39;q&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;u&#39;</span><span class="p">,</span><span class="s1">&#39;v&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span>]
</span><span class='line'><span class="c">  &quot; maps lowercase, uppercase and &lt;C-key&gt;</span>
</span><span class='line'>  <span class="k">call</span> submode#map<span class="p">(</span><span class="s1">&#39;window&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nb">key</span><span class="p">,</span> <span class="s1">&#39;&lt;C-w&gt;&#39;</span> . <span class="nb">key</span><span class="p">)</span>
</span><span class='line'>  <span class="k">call</span> submode#map<span class="p">(</span><span class="s1">&#39;window&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> toupper<span class="p">(</span><span class="nb">key</span><span class="p">),</span> <span class="s1">&#39;&lt;C-w&gt;&#39;</span> . toupper<span class="p">(</span><span class="nb">key</span><span class="p">))</span>
</span><span class='line'>  <span class="k">call</span> submode#map<span class="p">(</span><span class="s1">&#39;window&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;C-&#39;</span> . <span class="nb">key</span> . <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;C-w&gt;&#39;</span> . <span class="s1">&#39;&lt;C-&#39;</span>.<span class="nb">key</span> . <span class="s1">&#39;&gt;&#39;</span><span class="p">)</span>
</span><span class='line'><span class="k">endfor</span>
</span><span class='line'><span class="c">&quot; Go through symbols. Sadly, &#39;|&#39;, not supported in submode plugin.</span>
</span><span class='line'><span class="k">for</span> <span class="nb">key</span> <span class="k">in</span> [<span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39;+&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;&#39;</span>]
</span><span class='line'>  <span class="k">call</span> submode#map<span class="p">(</span><span class="s1">&#39;window&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nb">key</span><span class="p">,</span> <span class="s1">&#39;&lt;C-w&gt;&#39;</span> . <span class="nb">key</span><span class="p">)</span>
</span><span class='line'><span class="k">endfor</span>
</span><span class='line'>
</span><span class='line'><span class="c">&quot; Old way, just in case.</span>
</span><span class='line'><span class="nb">nnoremap</span> <span class="p">&lt;</span>Leader<span class="p">&gt;</span><span class="k">w</span> <span class="p">&lt;</span>C<span class="p">-</span><span class="k">w</span><span class="p">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>After <code>:source $MYVIMRC</code>, you&rsquo;ll have a glorious new submode in Vim.
You can see I named it <em>window</em> mode. Can you guess how to get into <em>window</em> mode?
<code>&lt;C-w&gt;</code>, the normal prefix used to do any <code>wincmd</code>. If this is too drastic, feel
free to change line #7 to something else. Just replace <code>&lt;C-w&gt;</code> with a different
normal mapping.</p>

<p>Let&rsquo;s give it a test drive.
<img class="featured" src="http://ddrscott.github.io/images/window-submode.gif" width="1142" height="719" title="'window mode in action'" >
I know you can&rsquo;t see what keys I&rsquo;m pressing, but I guarantee I only pressed
<code>&lt;C-w&gt;</code> once. I also didn&rsquo;t have to remember any new key bindings. The
hesitation in the demo is the resistance to hitting <code>&lt;C-w&gt;</code> every time, which
I&rsquo;ll get over soon enough.</p>

<h2>Bonus Mappings</h2>

<p>But wait there&rsquo;s more! In case I haven&rsquo;t provided enough tips for one post,
here&rsquo;s the overrides I have in <code>$MYVIMRC</code> to make windowing even better.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="c">&quot; I don&#39;t like &lt;C-w&gt;q, &lt;C-w&gt;c won&#39;t exit Vim when it&#39;s the last window.</span>
</span><span class='line'><span class="k">call</span> submode#map<span class="p">(</span><span class="s1">&#39;window&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;q&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;C-w&gt;c&#39;</span><span class="p">)</span>
</span><span class='line'><span class="k">call</span> submode#map<span class="p">(</span><span class="s1">&#39;window&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;C-q&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;C-w&gt;c&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c">&quot; &lt;lowercase-pipe&gt; sets the width to 80 columns, pipe (&lt;S-\&gt;) by default</span>
</span><span class='line'><span class="c">&quot; maximizes the width.</span>
</span><span class='line'><span class="k">call</span> submode#map<span class="p">(</span><span class="s1">&#39;window&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;\&#39;, &#39;</span>:<span class="k">vertical</span> <span class="k">resize</span> <span class="m">80</span><span class="p">&lt;</span>CR<span class="p">&gt;</span>&#39;<span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c">&quot; Resize faster</span>
</span><span class='line'><span class="k">call</span> submode#map<span class="p">(</span><span class="s1">&#39;window&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;3&lt;C-w&gt;+&#39;</span><span class="p">)</span>
</span><span class='line'><span class="k">call</span> submode#map<span class="p">(</span><span class="s1">&#39;window&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;3&lt;C-w&gt;-&#39;</span><span class="p">)</span>
</span><span class='line'><span class="k">call</span> submode#map<span class="p">(</span><span class="s1">&#39;window&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="s1">&#39;10&lt;C-w&gt;&lt;&#39;</span><span class="p">)</span>
</span><span class='line'><span class="k">call</span> submode#map<span class="p">(</span><span class="s1">&#39;window&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;10&lt;C-w&gt;&gt;&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Rainbows without Unicorns</h2>

<p>While learning this new way of windowing, there have been a few negatives:</p>

<ol>
<li><p>I forget that I&rsquo;m in window mode and get disoriented when I think I&rsquo;m moving
the cursor within a buffer, but it jumps around to other splits.</p></li>
<li><p>For one off window commands, I have to hit an extra key to get out of window
mode or wait for the timeout.</p></li>
<li><p>When I use some one else&rsquo;s computer, I&rsquo;m useless.</p></li>
</ol>


<p>I think most of these annoyances will go away with time, and the benefits
overtime in keystroke savings are non-trivial. As for #3, regardless of submodes,
the brain freeze will never go away, because no one thinks as strangely as me,
and that&rsquo;s a Good Thing™.</p>

<h2>Thanks</h2>

<p>Shout-out to Kana Natsuno, @kana1, <a href="http://whileimautomaton.net/,">http://whileimautomaton.net/,</a> <a href="https://github.com/kana">https://github.com/kana</a> . None
of this awesomeness would be possible without <a href="https://github.com/kana/vim-submode">https://github.com/kana/vim-submode</a> . She
makes some totally sweet plug-ins. Check out her stuff. You won&rsquo;t regret it!</p>

<p>Let me know what you think. Am I crazy? What other things deserve a submode?
Hit me up in the comments below! Thanks for reading!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Yank Without Jank]]></title>
    <link href="http://ddrscott.github.io/blog/2016/yank-without-jank/"/>
    <updated>2016-04-25T04:51:11-05:00</updated>
    <id>http://ddrscott.github.io/blog/2016/yank-without-jank</id>
    <content type="html"><![CDATA[<p><img class="featured" src="http://ddrscott.github.io/images/yank-default.gif" width="234" height="130" title="'Yank default jump'" ></p>

<p>For all the great things Vim has to offer, it still has some inconsistencies with
basic editors that I simply can&rsquo;t unlearn. One of these nasties is moving the cursor
after a visual yank. Go ahead, try it: <code>vipy</code>. Where&rsquo;s your cursor? Where did
you expect it to be located? When you&rsquo;re in a boring editor and do
<code>shift-down-down-down &lt;Cmd-c&gt;</code>, where&rsquo;s your cursor?  Where did you expect it
to be located? This janky behaviour always throws me off for a moment, then I
compose myself, do a <code>&lt;backtick&gt;&lt;greaterthan&gt;</code> to jump to the end of my selection, and <code>p</code>.</p>

<p>There must be a better way!</p>

<!-- more -->


<h2>Solution A</h2>

<p>Rebind <code>y</code> to do exactly what we did above:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="nb">vnoremap</span> <span class="k">y</span> <span class="k">y</span>`<span class="p">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>This work and I lived with it for a few minutes, but it still wasn&rsquo;t perfect. I
noticed when I do line select using capital <code>V</code> the cursor would still move. The
vertical motion was perfect, but horizontal motion was still jarring.</p>

<p><img class="featured" src="http://ddrscott.github.io/images/yank-solution-a.gif" width="234" height="130" title="'Yank tick greater than'" ></p>

<h2>Solution B</h2>

<p>Let&rsquo;s try using marks to keep things in place:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="nb">vnoremap</span> <span class="k">y</span> myy`<span class="k">y</span>
</span><span class='line'><span class="nb">vnoremap</span> Y myY`<span class="k">y</span>
</span></code></pre></td></tr></table></div></figure>


<p><img class="featured" src="http://ddrscott.github.io/images/2016-04-15-yank-without-jank_markdown.png" width="600" height="379" title="'Yank Without Jank Annotation'" >
The capital <code>Y</code> mapping is just in case we want to do a line wise yank from a
character wise selection.</p>

<p><img class="featured" src="http://ddrscott.github.io/images/yank-solution-b.gif" width="234" height="130" title="'Yank mark y'" ></p>

<p>Like a well trained dog, the cursor stays even though you yank it.</p>

<p><strong>BONUS</strong> This snippet also takes over the <code>y</code> marker, so you can manually
<code>&lt;backtick&gt;y</code> at a later time to continue yanking where you left off. This is great when
you&rsquo;re moving a lot of stuff around and want pick up where you last were. You
can also change the mark to capitals in the binding so it spans buffers, too.</p>

<h2>Closing</h2>

<p>I&rsquo;ve been using this setting for a while and noticed my blood pressure is way
down. No more yank anxiety means I&rsquo;m a step closer to editing utopia!</p>

<p>Let me know how this goes for you in the comments below.</p>

<h2>Updates from Comments</h2>

<p>Commenter @Krzysztof noticed Solution B wasn&rsquo;t allowing the user to specify
the target register. He was awesome enough to update the solution. Here&rsquo;s his
solution:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="nb">vnoremap</span> <span class="p">&lt;</span>expr<span class="p">&gt;</span><span class="k">y</span> <span class="s2">&quot;my\&quot;&quot;</span> . <span class="k">v</span>:<span class="k">register</span> . <span class="s2">&quot;y`y&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>I&rsquo;ve updated <code>$MYVIMRC</code> and it works great.
Thanks @Krzysztof for being awesome!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Vim Toggle Movement: I Just Want to Go Home]]></title>
    <link href="http://ddrscott.github.io/blog/2016/vim-toggle-movement/"/>
    <updated>2016-04-14T05:51:11-05:00</updated>
    <id>http://ddrscott.github.io/blog/2016/vim-toggle-movement</id>
    <content type="html"><![CDATA[<p><img class="featured" src="http://ddrscott.github.io/images/i_just_want_to_go_home.png" width="600" height="255" title="'I just want to go home'" ></p>

<p>I have a problem with the <code>^</code> key. I need its functionality, but its proximity is
too far for either of my stubby index fingers. No vimrc change can physically move it
closer to me, but I have found a way to move its funtionality to another a key.
A key which already knows how to go home. An alternate home. A home where my
heart isn&rsquo;t. Enough drama, what&rsquo;s the problem?!?</p>

<!-- more -->


<h2>The Problem</h2>

<p>In my daily coding, I have a deep seeded need to go to the first non-blank
character of a line. The only key that Vim provides for that functionality is <code>^</code>,
the hardest key to reach from the home row. A much more comfortable key to reach
is <code>0</code>, but that shoots us past the first non-blank character all the way to
the left edge of the window. <code>&lt;Home&gt;</code> is the ugly step child of either option
since it&rsquo;s even harder to reach and takes us to the first column, too.</p>

<p>In case you don&rsquo;t believe me. Here&rsquo;s what the Vim document says:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>  0          To the first character of the line.  |exclusive|
</span><span class='line'>        motion.
</span><span class='line'>
</span><span class='line'>                *&lt;Home&gt;* *&lt;kHome&gt;*
</span><span class='line'>  &lt;Home&gt;  To the first character of the line.  |exclusive|
</span><span class='line'>        motion.  When moving up or down next, stay in same
</span><span class='line'>        TEXT column (if possible).  Most other commands stay
</span><span class='line'>        in the same SCREEN column.  &lt;Home&gt; works like &quot;1|&quot;,
</span><span class='line'>        which differs from &quot;0&quot; when the line starts with a
</span><span class='line'>        &lt;Tab&gt;.
</span><span class='line'>
</span><span class='line'>                *^*
</span><span class='line'>  ^           To the first non-blank character of the line. |exclusive| motion.
</span></code></pre></td></tr></table></div></figure>


<p>Why can&rsquo;t I have a key that is easy to reach and takes me to the first
non-blank?!?</p>

<p><img src="http://ddrscott.github.io/images/venn_home_0.png" width="552" height="475" title="'venn diagram - home, caret, and 0'" ></p>

<p>I could swap the functionality of <code>0</code> and <code>^</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>nnoremap 0 ^
</span><span class='line'>nnoremap ^ 0
</span></code></pre></td></tr></table></div></figure>


<p>This still forces me to reach for <code>^</code> when I need to need to get to that left
edge. There must be a better way!</p>

<h2>The Solution</h2>

<p>Let&rsquo;s give <code>0</code> some super toggling powers. When I hit it the first time, I want it be
be like <code>^</code>. If I hit it again, I want it to finish its travels and go to the
first column.</p>

<h3>Solution A</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="k">function</span><span class="p">!</span> ToggleHomeZero<span class="p">()</span>
</span><span class='line'>  <span class="k">let</span> pos <span class="p">=</span> getpos<span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
</span><span class='line'>  execute <span class="s2">&quot;normal! ^&quot;</span>
</span><span class='line'>  <span class="k">if</span> pos <span class="p">==</span> getpos<span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
</span><span class='line'>    execute <span class="s2">&quot;normal! 0&quot;</span>
</span><span class='line'>  <span class="k">endif</span>
</span><span class='line'><span class="k">endfunction</span>
</span><span class='line'>
</span><span class='line'><span class="nb">nnoremap</span> <span class="m">0</span> :<span class="k">call</span> ToggleHome<span class="p">()&lt;</span>CR<span class="p">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>This gets us exactly to the center of Venn diagrams heart:</p>

<p><strong>Easy to reach + First non-blank character + First column = Rainbow Colored Unicorn!</strong></p>

<h3>Solution B</h3>

<p>After enjoying staring at the function for a while, I realized we could add
super toggling powers to other movements. Lets extract the <code>normal</code> commands
into arguments and share the love with other keys!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="k">function</span><span class="p">!</span> ToggleMovement<span class="p">(</span>firstOp<span class="p">,</span> thenOp<span class="p">)</span>
</span><span class='line'>  <span class="k">let</span> pos <span class="p">=</span> getpos<span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
</span><span class='line'>  execute <span class="s2">&quot;normal! &quot;</span> . <span class="k">a</span>:firstOp
</span><span class='line'>  <span class="k">if</span> pos <span class="p">==</span> getpos<span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
</span><span class='line'>    execute <span class="s2">&quot;normal! &quot;</span> . <span class="k">a</span>:thenOp
</span><span class='line'>  <span class="k">endif</span>
</span><span class='line'><span class="k">endfunction</span>
</span><span class='line'>
</span><span class='line'><span class="c">&quot; The original carat 0 swap</span>
</span><span class='line'><span class="nb">nnoremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;</span> <span class="m">0</span> :<span class="k">call</span> ToggleMovement<span class="p">(</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">)&lt;</span>CR<span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="c">&quot; How about ; and ,</span>
</span><span class='line'><span class="nb">nnoremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;</span> ; :<span class="k">call</span> ToggleMovement<span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)&lt;</span>CR<span class="p">&gt;</span>
</span><span class='line'><span class="nb">nnoremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;</span> <span class="p">,</span> :<span class="k">call</span> ToggleMovement<span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)&lt;</span>CR<span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="c">&quot; How about H and L</span>
</span><span class='line'><span class="nb">nnoremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;</span> H :<span class="k">call</span> ToggleMovement<span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">)&lt;</span>CR<span class="p">&gt;</span>
</span><span class='line'><span class="nb">nnoremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;</span> L :<span class="k">call</span> ToggleMovement<span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">)&lt;</span>CR<span class="p">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="c">&quot; How about G and gg</span>
</span><span class='line'><span class="nb">nnoremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;</span> G :<span class="k">call</span> ToggleMovement<span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;gg&#39;</span><span class="p">)&lt;</span>CR<span class="p">&gt;</span>
</span><span class='line'><span class="nb">nnoremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;</span> gg :<span class="k">call</span> ToggleMovement<span class="p">(</span><span class="s1">&#39;gg&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">)&lt;</span>CR<span class="p">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Conclusion</h2>

<p><code>ToggleMovement</code> is the gift that keeps on giving!</p>

<p>What other movement can we add to the list?
Let me know in the comments below.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[BS to the Black Hole]]></title>
    <link href="http://ddrscott.github.io/blog/2016/bs-to-the-black-hole/"/>
    <updated>2016-04-13T00:48:47-05:00</updated>
    <id>http://ddrscott.github.io/blog/2016/bs-to-the-black-hole</id>
    <content type="html"><![CDATA[<p><img class="featured" src="http://ddrscott.github.io/images/blackhole_bs.png" width="800" height="469" title="'BS to Black Hole'" ></p>

<p>First post in 2 years. Sorry to keep you waiting.</p>

<p>I&rsquo;ve been playing with Vim again, more specifically NeoVim
<a href="https://neovim.io/,">https://neovim.io/,</a> and this time I think it&rsquo;s going to stick.</p>

<h2>The Problem</h2>

<p>Sometimes, I want to delete text without worrying about blowing away the <code>unnamed</code>
register. This can be done by prefixing a normal or visual delete with <code>"_</code>,
but that&rsquo;s an awkward dance for my pinky and ring finger. Go ahead, try it.
You&rsquo;ll feel like you&rsquo;re in junior high again.</p>

<!-- more -->


<h2>Solution #1</h2>

<p>Setup a single key to do that <code>"_</code> thing for me. So my naive approach was to add
the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="nb">nnoremap</span> <span class="p">&lt;</span>BS<span class="p">&gt;</span> <span class="c">&quot;_</span>
</span><span class='line'><span class="nb">vnoremap</span> <span class="p">&lt;</span>BS<span class="p">&gt;</span> <span class="c">&quot;_</span>
</span></code></pre></td></tr></table></div></figure>


<p>This was fine for 32.1 seconds of usability testing. It did the job, but what
cames after a <code>"_</code> was usually a <code>dw</code> or <code>db</code> operator. Ah oh, I said the &ldquo;o&rdquo;
word. That means I have to make a <code>opfunc</code>. (Who makes these rules?!?)</p>

<h2>Solution #2</h2>

<p>So what is this operator going to let us do? How about <code>&lt;BS&gt;iw</code> or <code>&lt;BS&gt;ap</code> or
<code>v{motion around something you hate}&lt;BS&gt;</code>? If any of those seem awesome, here&rsquo;s
how to get in on the hot action!</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='vim'><span class='line'><span class="c">&quot; Add to your .vimrc or init.vim or vim.after or :e $MYVIMRC</span>
</span><span class='line'>func<span class="p">!</span> BlackHoleDeleteOperator<span class="p">(</span>type<span class="p">)</span>
</span><span class='line'>  <span class="k">if</span> <span class="k">a</span>:type <span class="p">==</span># <span class="s1">&#39;char&#39;</span>
</span><span class='line'>    execute <span class="s1">&#39;normal! `[v`]&quot;_d&#39;</span>
</span><span class='line'>  <span class="k">elseif</span> <span class="k">a</span>:type <span class="p">==</span># <span class="s1">&#39;line&#39;</span>
</span><span class='line'>    execute <span class="s1">&#39;normal! `[V`]&quot;_d&#39;</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>    execute <span class="s1">&#39;normal! `&lt;&#39;</span> . <span class="k">a</span>:type . <span class="s1">&#39;`&gt;&quot;_d&#39;</span>
</span><span class='line'>  <span class="k">endif</span>
</span><span class='line'><span class="k">endf</span>
</span><span class='line'>
</span><span class='line'><span class="c">&quot; Map to &lt;BS&gt; because it&#39;s under worked in Vim.</span>
</span><span class='line'><span class="nb">nnoremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;</span> <span class="p">&lt;</span>BS<span class="p">&gt;</span> <span class="p">&lt;</span>Esc<span class="p">&gt;</span>:<span class="k">set</span> <span class="nb">opfunc</span><span class="p">=</span>BlackHoleDeleteOperator<span class="p">&lt;</span>CR<span class="p">&gt;</span><span class="k">g</span>@
</span><span class='line'><span class="nb">vnoremap</span> <span class="p">&lt;</span><span class="k">silent</span><span class="p">&gt;</span> <span class="p">&lt;</span>BS<span class="p">&gt;</span> :<span class="p">&lt;</span>C<span class="p">-</span><span class="k">u</span><span class="p">&gt;</span><span class="k">call</span> BlackHoleDeleteOperator<span class="p">(</span>visualmode<span class="p">())&lt;</span>CR<span class="p">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>How Does it Work?</h2>

<ul>
<li><p><code>opfunc</code> is best explained in Vim help. Use <code>:help opfunc</code> and follow the <code>&lt;C-]&gt;</code>
 until clarity is achieved.</p></li>
<li><p><code>:help normal</code> &ndash; evaluates the following characters as if they were typed.</p></li>
<li><p><code>:help marks</code> &ndash; page down a bit to get the list of automatic marks based on
 last positions of various changes, jumps, and actions.</p></li>
<li><p><a href="http://learnvimscriptthehardway.stevelosh.com/chapters/33.html">http://learnvimscriptthehardway.stevelosh.com/chapters/33.html</a> &ndash; seriously,
 this guy does a lot better explaining than me. Learn it the hard way, first,
 ask questions later.</p></li>
</ul>


<h2>Closing</h2>

<p>Thanks for getting this far. Do you have a better mapping for <code>&lt;BS&gt;</code>? Do you
have a more creative solution than typing <code>"_</code> to access the black hole
register? Let me know by commenting or share this post to some one who does.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Octopress to the Rescue]]></title>
    <link href="http://ddrscott.github.io/blog/2014/octopress-to-the-rescue/"/>
    <updated>2014-04-16T23:31:31-05:00</updated>
    <id>http://ddrscott.github.io/blog/2014/octopress-to-the-rescue</id>
    <content type="html"><![CDATA[<p><img class="featured" src="http://ddrscott.github.io/images/octopress_logo.png" width="227" height="227" title="'Octopress Logo'" ></p>

<p>After nearly a year without Posterous, I&rsquo;ve finally got around to migrating to another system.
This time around it&rsquo;s a static blog builder: <a href="http://octopress.org/">http://octopress.org/</a></p>

<!-- more -->


<p>Octopress is a wrapper around Jekyll which is a utility for creating a static blogging site. A blog that can be
hosted on anything that can server files: Apache, AWS, Dropbox, etc&hellip;</p>

<h3>Q: Why not use WordPress, Tumbler, Blogger?!?</h3>

<p>Those tailor to non-developers and their editors are not the ones I use everyday, my IDE. Octopress lets me
write my articles the same way as I write code: plain text. It uses markdown or any other HTML generator I configure.</p>

<p>Static pages are easier for me to deploy when I have to switch hosting providers. Hopefully Github sticks around
for a while, but if they don&rsquo;t, I can rest assured I can have the article hosted some where else faster than DNS propagation.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">puts</span> <span class="s2">&quot;I can use code snippets&quot;</span>
</span><span class='line'><span class="c1"># And they will be nicely formatted.</span>
</span><span class='line'><span class="n">maybe_one_day</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">use</span><span class="p">(</span><span class="no">CodePen</span><span class="p">)</span> <span class="ow">or</span> <span class="n">use</span><span class="p">(</span><span class="n">jsFiddle</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>The initial theme I selected is <a href="https://github.com/sevenadrian/MediumFox.">https://github.com/sevenadrian/MediumFox.</a> It&rsquo;s clean, simple and pretty much
what I would have <em>tried</em> to make if I had time. They seemed to have omitted some features from the classic theme, but
as with all Open Source projects it is easy to remedy.</p>

<p>Time to post to do my first deploy&hellip; then convert all the Posterous archives.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Building Unix-style command line applications]]></title>
    <link href="http://ddrscott.github.io/blog/2012/writing-stuff-for-command-lines-this-is-a-goo/"/>
    <updated>2012-08-08T12:49:56-05:00</updated>
    <id>http://ddrscott.github.io/blog/2012/writing-stuff-for-command-lines-this-is-a-goo</id>
    <content type="html"><![CDATA[Writing stuff for command lines? This is a good place to start.
Covers Ruby&#8217;s `ARGF` and standard library `optparse`.

<h6>Source: practicingruby.com</h6>
<a href=
"http://practicingruby.com/articles/shared/qyxvmrgmhuln">Building Unix-style command line applications</a>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Backpocket 2.0]]></title>
    <link href="http://ddrscott.github.io/blog/2012/backpocket-20/"/>
    <updated>2012-08-03T09:07:00-05:00</updated>
    <id>http://ddrscott.github.io/blog/2012/backpocket-20</id>
    <content type="html"><![CDATA[<p>I&#8217;m sick of small &#8220;sexy&#8221; devices. I want a full screen every
where I go. So I want some one to make this for us, and get a big
celebrity to sport it and make it cool. I know I can&#8217;t pull it off
alone.</p>
<p>I&#8217;m hoping the future Galaxy Note/Tab 3.0 can be hugged by
Backpocket 2.0&#8217;s embrace.&nbsp;</p>
<div class='p_embed p_image_embed'><img alt="Back_pocket_2" height=
"465" src=
"http://ddrscott.github.io/images/2012/08/43442282-Back_Pocket_2.0_-_Page_1.jpg"
width="401"></div>
(drawn with <a href=
"https://play.google.com/store/apps/details?id=com.steadfastinnovation.android.projectpapyrus&amp;hl=en"
title="Papyrus - Google Play" target="_blank">Papyrus</a>&nbsp;on
my Galaxy Note)
<p>So what do you think tech boys and girls? Leave your comments
below.</p>
<!-- more -->
<p><strong>[Update]</strong></p>
<p>Aparently another company has already made a large pocket, but
hasn&#8217;t put it on the back yet.&nbsp;<a href=
"http://www.thinkofthe.com/product.php?name=large-pocket-shirt">http://www.thinkofthe.com/product.php?name=large-pocket-shirt</a></p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Measure Linux Manhood using Busybox]]></title>
    <link href="http://ddrscott.github.io/blog/2012/measure-linux-manhood-using-busybox/"/>
    <updated>2012-07-11T22:17:00-05:00</updated>
    <id>http://ddrscott.github.io/blog/2012/measure-linux-manhood-using-busybox</id>
    <content type="html"><![CDATA[<img class="featured" src="http://www.busybox.net/images/busybox1.png" width="164" height="116" title="'Busybox'" >

For those in the embedded Linux world, Busybox seems to be the
single most important thing to have in their filesystem other than
OS itself. This is something I just recently discovered as I
started rooting my Android devices. Prior to Busybox I&rsquo;ve
been stuck using my laptop to edit files, then using
<code>adb</code> commands to get things to the right location on
the device. When I was really stuck, I&rsquo;d end up using
<code>adb shell</code> and the simplified utilities that are in
<code>/system/bin</code>. But now with Busybox I have access to all
the commands I&rsquo;m accustom to using in a full Linux/Unix
distribution.

<!-- more -->
<p>What is Busybox, exactly? According to their documentation,
&ldquo;BusyBox combines tiny versions of many common UNIX utilities
into a single small executable. It provides minimalist replacements
for most of the utilities you usually find in GNU coreutils,
util-linux, etc.&rdquo;</p>
<p>For years I&rsquo;ve been too lazy or intimidated by Linux and
its super huge list of programs that I&rsquo;ve never really spent
the time to figure out which utils I should really know and which
are just gravy. For instance if I use Ubuntu&rsquo;s package
manager to install a program, I&rsquo;m bombarded with tens of
thousands of possibilities. ~38,500 according to this <a href=
"http://askubuntu.com/questions/111753/how-many-i386-and-amd64-packages-exist">
answer</a>. Who has time to evaluate all those programs?!?</p>
<h1>Test of Man/Womanhood</h1>
<p>So where am I going with all this? What about the Test of
Manhood? If Busybox is so great and contains commonly used
functions, then I assert that one of a Linux
Admins&acirc;&euro;&trade; job interview questions should be,
&ldquo;Give a short description of each one of these commands and
when you would use it.&rdquo; Then toss the Busybox command/applet
list across the table and stare intensely at the candidate.</p>
<h1>Busybox Test</h1>
<p>I am not a Linux expert, but I can get a system running in a
pinch. My rough guess is I have fluency in only 10% of the Busybox
commands, and the rest I have to Google or take by blind faith when
I use some online shell snippet. I want to put that 10% to the
test. I&rsquo;m going to answer my own interview question, and
you&rsquo;ll just need to trust me that I&rsquo;m not using the
Busybox <a href="http://www.busybox.net/downloads/BusyBox.html"
title="Busybox Manual">manual</a> during the test. Actually, I have
no reason to cheat since I&rsquo;m really doing this to see how
much I don&rsquo;t know, and as a benchmark for how I can improve
in the future.</p>
<ol>
<li><code>acpid</code> &ndash; ?</li>
<li><code>addgroup</code> &ndash; add a group by ID or name to a
user</li>
<li><code>adduser</code> &ndash; add a user to the system</li>
<li><code>adjtimex</code> &ndash; adjust time?</li>
<li><code>ar</code> &ndash; ? archive?</li>
<li><code>arp</code> &ndash; related to networking, but I have no
idea</li>
<li><code>arping</code> &ndash; ?</li>
<li><code>ash</code> &ndash; huh?</li>
<li><code>awk</code> &ndash; stream parsing? I&rsquo;ve never used
it but often hear it mentioned with <code>sed</code></li>
<li><code>basename</code> &ndash; ?</li>
<li><code>beep</code> &ndash; make a beep, I&rsquo;ve always used
<code>echo -e '\07'</code></li>
<li><code>blkid</code> &ndash; ?</li>
<li><code>brctl</code> &ndash; ?</li>
<li><code>bunzip2</code> &ndash; decompress bz2 archive files</li>
<li><code>bzcat</code> &ndash; send to stdout the decompressed
contents of a bz2 archive</li>
<li><code>bzip2</code> &ndash; compress a file using bz2
format</li>
<li><code>cal</code> &ndash; show the calendar</li>
<li><code>cat</code> &ndash; send to stdout the contents of a
file</li>
<li><code>catv</code> &ndash; related to cat?</li>
<li><code>chat</code> &ndash; you can do this?!?</li>
<li><code>chattr</code> &ndash; ? change file attributes ?</li>
<li><code>chgrp</code> &ndash; similar to chown, but only affect
the group portion?</li>
<li><code>chmod</code> &ndash; change file permissions</li>
<li><code>chown</code> &ndash; change the owner of a file. can
change user or group ownership.</li>
<li><code>chpasswd</code> &ndash; never used, but guessing it would
change a password. I think <code>passwd</code> does the same
thing.</li>
<li><code>chpst</code> &ndash; ?</li>
<li><code>chroot</code> &ndash; change where &ldquo;/&rdquo; is
located in the file system. never used. Might be good for
sandboxing guest users?</li>
<li><code>chrt</code> &ndash; abbreviation for
<code>chroot</code>?</li>
<li><code>chvt</code> &ndash; ?</li>
<li><code>cksum</code> &ndash; generate a statistically unique
number based on the contents of the stdin or a file.</li>
<li><code>clear</code> &ndash; clear the terminal screen</li>
<li><code>cmp</code> &ndash; ? compare?</li>
<li><code>comm</code> &ndash; ?</li>
<li><code>cp</code> &ndash; copy a file</li>
<li><code>cpio</code> &ndash; ? copy a stream or more low level
copy ?</li>
<li><code>crond</code> &ndash; a daemon to run programs according
to a schedule</li>
<li><code>crontab</code> &ndash; manage a cron schedule</li>
<li><code>cryptpw</code> &ndash; ?</li>
<li><code>cut</code> &ndash; split stdin or a file into an
array</li>
<li><code>date</code> &ndash; output system time. can send it
format args</li>
<li><code>dc</code> &ndash; ? direct copy? I think I&rsquo;ve run
into this during disk formatting.</li>
<li><code>dd</code> &ndash; ? direct device copy? used in
conjunction with <code>dc</code>?</li>
<li><code>deallocvt</code> &ndash; ?</li>
<li><code>delgroup</code> &ndash; remove a group from a user</li>
<li><code>deluser</code> &ndash; remove a user</li>
<li><code>depmod</code> &ndash; ?</li>
<li><code>devmem</code> &ndash; ?</li>
<li><code>df</code> &ndash; device fullness. (my own way to
remember it). Display current disk usage.</li>
<li><code>dhcprelay</code> &ndash; ? something related to dhcp</li>
<li><code>diff</code> &ndash; show the difference of 2 files</li>
<li><code>dirname</code> &ndash; never used it, I think
<code>pwd</code> is more common</li>
<li><code>dmesg</code> &ndash; ?</li>
<li><code>dnsd</code> &ndash; DNS daemon</li>
<li><code>dnsdomainname</code> &ndash; ?</li>
<li><code>dos2unix</code> &ndash; change the line delimiters of a
file to/from DOS style <code>\r\n</code> to UNIX
<code>\n</code></li>
<li><code>dpkg</code> &ndash; Debian program packaging utility</li>
<li><code>du</code> &ndash; Disk Usage. How much space is the
current directory using on disk.</li>
<li><code>dumpkmap</code> &ndash; ?</li>
<li><code>dumpleases</code> &ndash; ?</li>
<li><code>echo</code> &ndash; print to stdout</li>
<li><code>ed</code> &ndash; old school line editor. I&rsquo;m not
old enough. Never used it.</li>
<li><code>egrep</code> &ndash; extended <code>grep</code> which
allows for more advanced regular expressions</li>
<li><code>eject</code> &ndash; ? remove a floppy or CD ?</li>
<li><code>env</code> &ndash; ?</li>
<li><code>envdir</code> &ndash; ?</li>
<li><code>envuidgid</code> &ndash; ?</li>
<li><code>expand</code> &ndash; ?</li>
<li><code>expr</code> &ndash; ?</li>
<li><code>fakeidentd</code> &ndash; ?</li>
<li><code>false</code> &ndash; not true? used in scripting ?</li>
<li><code>fbset</code> &ndash; ?</li>
<li><code>fbsplash</code> &ndash; ?</li>
<li><code>fdflush</code> &ndash; ?</li>
<li><code>fdformat</code> &ndash; ?</li>
<li><code>fdisk</code> &ndash; ?</li>
<li><code>fgrep</code> &ndash; related to grep? what the
&ldquo;f&rdquo;?</li>
<li><code>find</code> &ndash; find files based on various
attributes</li>
<li><code>findfs</code> &ndash; ? Like find is some way?</li>
<li><code>flash_lock</code> &ndash; ?</li>
<li><code>flash_unlock</code> &ndash; ?</li>
<li><code>fold</code> &ndash; ? Laundry?</li>
<li><code>free</code> &ndash; ? Disk or memory?</li>
<li><code>freeramdisk</code> &ndash; ?</li>
<li><code>fsck</code> &ndash; file system checker</li>
<li><code>fsck.minix</code> &ndash; ?</li>
<li><code>fsync</code> &ndash; ?</li>
<li><code>ftpd</code> &ndash; FTP daemon</li>
<li><code>ftpget</code> &ndash; get file from FTP server</li>
<li><code>ftpput</code> &ndash; put a file onto an FTP server</li>
<li><code>fuser</code> &ndash; ?</li>
<li><code>getopt</code> &ndash; ? Helper for writing scripts?</li>
<li><code>getty</code> &ndash; ?</li>
<li><code>grep</code> &ndash; find text in a file or stdin</li>
<li><code>gunzip</code> &ndash; decompress a gz archive</li>
<li><code>gzip</code> &ndash; compress a file into a gz
archive</li>
<li><code>hd</code> &ndash; ?</li>
<li><code>hdparm</code> &ndash; ? get parameters from hard
drive?</li>
<li><code>head</code> &ndash; output to N number of lines from a
file or stdin</li>
<li><code>hexdump</code> &ndash; ? Dump contents as hex
characters</li>
<li><code>hostid</code> &ndash; ?</li>
<li><code>hostname</code> &ndash; hostname of the machine, and set
it using the same command</li>
<li><code>httpd</code> &ndash; webserver daemon, I wonder it is
Apache</li>
<li><code>hush</code> &ndash; ?</li>
<li><code>hwclock</code> &ndash; ? Hardware clock?</li>
<li><code>id</code> &ndash; ?</li>
<li><code>ifconfig</code> &ndash; manage network interfaces</li>
<li><code>ifdown</code> &ndash; turn off a network interface</li>
<li><code>ifenslave</code> &ndash; ?</li>
<li><code>ifplugd</code> &ndash; ?</li>
<li><code>ifup</code> &ndash; turn on a network interface</li>
<li><code>inetd</code> &ndash; ? I should know this, but I
don&rsquo;t</li>
<li><code>init</code> &ndash; ?</li>
<li><code>inotifyd</code> &ndash; ?</li>
<li><code>insmod</code> &ndash; ?</li>
<li><code>install</code> &ndash; ? Install what and where?</li>
<li><code>ionice</code> &ndash; ?</li>
<li><code>ip</code> &ndash; ? Related to networking&hellip;</li>
<li><code>ipaddr</code> &ndash; ?</li>
<li><code>ipcalc</code> &ndash; ?</li>
<li><code>ipcrm</code> &ndash; ?</li>
<li><code>ipcs</code> &ndash; ?</li>
<li><code>iplink</code> &ndash; ?</li>
<li><code>iproute</code> &ndash; ?</li>
<li><code>iprule</code> &ndash; ?</li>
<li><code>iptunnel</code> &ndash; ?</li>
<li><code>kbd_mode</code> &ndash; ? Keyboard mode?</li>
<li><code>kill</code> &ndash; kill a running process</li>
<li><code>killall</code> &ndash; kill all processes matching a
criteria</li>
<li><code>killall5</code> &ndash; ?</li>
<li><code>klogd</code> &ndash; ?</li>
<li><code>last</code> &ndash; ? like tail?</li>
<li><code>length</code> &ndash; ?</li>
<li><code>less</code> &ndash; file viewer with VI style
navigation</li>
<li><code>linux32</code> &ndash; ?</li>
<li><code>linux64</code> &ndash; ?</li>
<li><code>linuxrc</code> &ndash; ?</li>
<li><code>ln</code> &ndash; link a file to another location</li>
<li><code>loadfont</code> &ndash; ?</li>
<li><code>loadkmap</code> &ndash; ?</li>
<li><code>logger</code> &ndash; ?</li>
<li><code>login</code> &ndash; login as another user</li>
<li><code>logname</code> &ndash; ?</li>
<li><code>logread</code> &ndash; ?</li>
<li><code>losetup</code> &ndash; ?</li>
<li><code>lpd</code> &ndash; ?</li>
<li><code>lpq</code> &ndash; ?</li>
<li><code>lpr</code> &ndash; ?</li>
<li><code>ls</code> &ndash; list files to stdout</li>
<li><code>lsattr</code> &ndash;?</li>
<li><code>lsmod</code> &ndash; ?</li>
<li><code>lzmacat</code> &ndash; ?</li>
<li><code>lzop</code> &ndash; ?</li>
<li><code>lzopcat</code> &ndash; ?</li>
<li><code>makemime</code> &ndash; ?</li>
<li><code>man</code> &ndash; view manual of a command. <code>man
busybox</code></li>
<li><code>md5sum</code> &ndash; like <code>cksum</code> but more
commonly used</li>
<li><code>mdev</code> &ndash; ?</li>
<li><code>mesg</code> &ndash; ?</li>
<li><code>microcom</code> &ndash; ?</li>
<li><code>mkdir</code> &ndash; make a directory</li>
<li><code>mkdosfs</code> &ndash; ? make DOS file system?</li>
<li><code>mkfifo</code> &ndash; ?</li>
<li><code>mkfs.minix</code> &ndash; ?</li>
<li><code>mkfs.vfat</code> &ndash; ?</li>
<li><code>mknod</code> &ndash; ?</li>
<li><code>mkpasswd</code> &ndash; ?</li>
<li><code>mkswap</code> &ndash; ?</li>
<li><code>mktemp</code> &ndash; ?</li>
<li><code>modprobe</code> &ndash; ?</li>
<li><code>more</code> &ndash; predecessor to <code>less</code> and
has fewer features. Many systems link <code>more</code> to
<code>less</code></li>
<li><code>mount</code> &ndash; mount a device to file system
path</li>
<li><code>mountpoint</code> &ndash; ?</li>
<li><code>mt</code> &ndash; ?</li>
<li><code>mv</code> &ndash; move file to another path</li>
<li><code>nameif</code> &ndash; ?</li>
<li><code>nc</code> &ndash; ?</li>
<li><code>netstat</code> &ndash; get network statistics</li>
<li><code>nice</code> &ndash; change CPU priority of a process</li>
<li><code>nmeter</code> &ndash; ?</li>
<li><code>nohup</code> &ndash; run process detatched from current
shell and as system root process</li>
<li><code>nslookup</code> &ndash; lookup IP address of DNS
name</li>
<li><code>od</code> &ndash; ?</li>
<li><code>openvt</code> &ndash; ?</li>
<li><code>passwd</code> &ndash; change password</li>
<li><code>patch</code> &ndash; apply difference file generated by
<code>diff</code></li>
<li><code>pgrep</code> &ndash; ? What the &lsquo;p&rsquo;?</li>
<li><code>pidof</code> &ndash; ?</li>
<li><code>ping</code> &ndash; check for existence of another
IP</li>
<li><code>ping6</code> &ndash; same as <code>ping</code> but for
IPv6</li>
<li><code>pipe_progress</code> &ndash; ? sounds interesting</li>
<li><code>pivot_root</code> &ndash;?</li>
<li><code>pkill</code> &ndash; kill all processes named X</li>
<li><code>popmaildir</code> &ndash; ? related to POP mail</li>
<li><code>printenv</code> &ndash; ?</li>
<li><code>printf</code> &ndash; ?</li>
<li><code>ps</code> &ndash; process list, list all currently
running processes</li>
<li><code>pscan</code> &ndash; ?</li>
<li><code>pwd</code> &ndash; current working directory</li>
<li><code>raidautorun</code> &ndash; ?</li>
<li><code>rdate</code> &ndash; ?</li>
<li><code>rdev</code> &ndash; ?</li>
<li><code>readlink</code> &ndash; ?</li>
<li><code>readprofile</code> &ndash; ?</li>
<li><code>realpath</code> &ndash; ?</li>
<li><code>reformime</code> &ndash; ?</li>
<li><code>renice</code> &ndash; ?</li>
<li><code>reset</code> &ndash; ?</li>
<li><code>resize</code> &ndash; ?</li>
<li><code>rm</code> &ndash; remove file</li>
<li><code>rmdir</code> &ndash; remove directory</li>
<li><code>rmmod</code> &ndash;?</li>
<li><code>route</code> &ndash; ? related to networking</li>
<li><code>rpm</code> &ndash; Redhat package manager?</li>
<li><code>rpm2cpio</code> &ndash; ?</li>
<li><code>rtcwake</code> &ndash; ?</li>
<li><code>run-parts</code> &ndash; ?</li>
<li><code>runlevel</code> &ndash; ?</li>
<li><code>runsv</code> &ndash; ?</li>
<li><code>runsvdir</code> &ndash; ?</li>
<li><code>rx</code> &ndash; ? Prescription Drugs? How
convienant</li>
<li><code>script</code> &ndash; ?</li>
<li><code>scriptreplay</code> &ndash; ?</li>
<li><code>sed</code> &ndash; stream editor</li>
<li><code>sendmail</code> &ndash; ? related to email</li>
<li><code>seq</code> &ndash; ?</li>
<li><code>setarch</code> &ndash; ?</li>
<li><code>setconsole</code> &ndash; ?</li>
<li><code>setfont</code> &ndash; ?</li>
<li><code>setkeycodes</code> &ndash; ?</li>
<li><code>setlogcons</code> &ndash; ?</li>
<li><code>setsid</code> &ndash; ?</li>
<li><code>setuidgid</code> &ndash; ?</li>
<li><code>sh</code> &ndash; start a new shell</li>
<li><code>sha1sum</code> &ndash; check sum generator like
<code>cksum</code> and <code>md5sum</code> but considered more
random. This is the 128 bits version.</li>
<li><code>sha256sum</code> &ndash; same as above but more bits</li>
<li><code>sha512sum</code> &ndash; even more bits</li>
<li><code>showkey</code> &ndash; ?</li>
<li><code>slattach</code> &ndash; ?</li>
<li><code>sleep</code> &ndash; suspend computer</li>
<li><code>softlimit</code> &ndash; ?</li>
<li><code>sort</code> &ndash; sort contents of stdin or file.
Output to stdout</li>
<li><code>split</code> &ndash; ? I can guess, but didn&rsquo;t know
this existed.</li>
<li><code>start-stop-daemon</code> &ndash; ?</li>
<li><code>stat</code> &ndash; ?</li>
<li><code>strings</code> &ndash; ?</li>
<li><code>stty</code> &ndash; ?</li>
<li><code>su</code> &ndash; switch user</li>
<li><code>sulogin</code> &ndash; ?</li>
<li><code>sum</code> &ndash; ?</li>
<li><code>sv</code> &ndash; ?</li>
<li><code>svlogd</code> &ndash; ?</li>
<li><code>swapoff</code> &ndash; ?</li>
<li><code>swapon</code> &ndash; ?</li>
<li><code>switch_root</code> &ndash; ?</li>
<li><code>sync</code> &ndash; ?</li>
<li><code>sysctl</code> &ndash; ? Sounds familar</li>
<li><code>syslogd</code> &ndash; logging daemon</li>
<li><code>tac</code> &ndash; opposite of <code>cat</code>, will
print in reverse order</li>
<li><code>tail</code> &ndash; output end of a file or steam</li>
<li><code>tar</code> &ndash; create an archive of one or more
files</li>
<li><code>taskset</code> &ndash; ?</li>
<li><code>tcpsvd</code> &ndash; ?</li>
<li><code>tee</code> &ndash; write stdout to a file and still
output to screen</li>
<li><code>telnet</code> &ndash; client to connect to another
machine/hosts</li>
<li><code>telnetd</code> &ndash; telnet daemon to allow connections
from other hosts</li>
<li><code>test</code> &ndash; ?</li>
<li><code>tftp</code> &ndash; ? What is the &rsquo;t&#8217;?</li>
<li><code>tftpd</code> &ndash; ? FTP server daemon. What is the
&rsquo;t&#8217;?</li>
<li><code>time</code> &ndash; time how long a program takes to run.
I often type this instead of <code>date</code> wanting to know what
time it is on the server, and I&rsquo;m always disappointed by the
0 result</li>
<li><code>timeout</code> &ndash; ? sounds interesting</li>
<li><code>top</code> &ndash; nice UI of top processes</li>
<li><code>touch</code> &ndash; change to modified timestamp of a
file to now. Will create an empty file it doesn&rsquo;t exist</li>
<li><code>tr</code> &ndash; ?</li>
<li><code>traceroute</code> &ndash; check how many network hops the
current host is from another host</li>
<li><code>true</code> &ndash; ?</li>
<li><code>tty</code> &ndash; ?</li>
<li><code>ttysize</code> &ndash; ?</li>
<li><code>udhcpc</code> &ndash; ?</li>
<li><code>udhcpd</code> &ndash; ?</li>
<li><code>udpsvd</code> &ndash; ?</li>
<li><code>umount</code> &ndash; unmount a device from file
system</li>
<li><code>uname</code> &ndash; output info about current OS
installation</li>
<li><code>uncompress</code> &ndash; ? decompress a file, never used
before</li>
<li><code>unexpand</code> &ndash; ? Ditto</li>
<li><code>uniq</code> &ndash; outputs unique occurrences of a line
from a file or stdout. Input must already be sorted.</li>
<li><code>unix2dos</code> &ndash; opposite of
<code>dos2unix</code></li>
<li><code>unlzma</code> &ndash; ?</li>
<li><code>unlzop</code> &ndash; ?</li>
<li><code>unzip</code> &ndash; decompress a zip archive</li>
<li><code>uptime</code> &ndash; ?</li>
<li><code>usleep</code> &ndash; ?</li>
<li><code>uudecode</code> &ndash; ? What is UU?</li>
<li><code>uuencode</code> &ndash; ?</li>
<li><code>vconfig</code> &ndash; ?</li>
<li><code>vi</code> &ndash; visual editor</li>
<li><code>vlock</code> &ndash; ?</li>
<li><code>volname</code> &ndash; ?</li>
<li><code>watch</code> &ndash; continuously run a program and
output the results watching for differences</li>
<li><code>watchdog</code> &ndash;?</li>
<li><code>wc</code> &ndash; word count, outputs lines then words
then character count</li>
<li><code>wget</code> &ndash; pull a HTTP resource into file or
stdout</li>
<li><code>which</code> &ndash; output the full path of a
program</li>
<li><code>who</code> &ndash; who else is logged into current
host</li>
<li><code>whoami</code> &ndash; which user I is my session</li>
<li><code>xargs</code> &ndash; ? I&#8217;be always wanted to learn this
one&hellip;</li>
<li><code>yes</code> &ndash; output &lsquo;y&rsquo; to stdin.
Useful for automatically confirmation of install prompts</li>
<li><code>zcat</code> &ndash; <code>cat</code> the contents of a gz
archive</li>
<li><code>zcip</code> &ndash; ?</li>
</ol>
<h1>Conclusion</h1>
<p>Three hundred and eight commands later&hellip; I&rsquo;m tired.
And as you can see, I have a long way to go. 99 commands known, and
209 commands unknown. 33% is better than the predicted 10%
<strong>Woohoo!</strong></p>
<p>Now I have the task of reading the <a href=
"http://www.busybox.net/downloads/BusyBox.html" title=
"Busybox Manual">Busybox documentation</a> more thoroughly to see
what I&rsquo;ve been missing my whole shell life.</p>
<p>So where do you stand on the Busybox challenge? Are the Busybox
commands already at your mercy or is it this the missing Linux
link? Post your percentage in the comments.</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[This is a Test Phone Blog]]></title>
    <link href="http://ddrscott.github.io/blog/2012/this-is-a-test-phone-blog/"/>
    <updated>2012-07-07T08:23:00-05:00</updated>
    <id>http://ddrscott.github.io/blog/2012/this-is-a-test-phone-blog</id>
    <content type="html"><![CDATA[<p>The jury is still out on whether I can productively write
anything on a mobile device. I just received a Galaxy Note,
installed Hackers Keyboard, and installed Writer app. The Note
provides nearly an extra inch of keyboard while the Hackers
Keyboard provides all the typical keys on used to on a desktop.
Lastly was finding an app that highlights my favorite plain text
writing language, Markdown.</p>
<!-- more -->
<h2>The Galaxy Note</h2>
<p>The Galaxy Note is an interesting writing device due to its
size. I did get used to typing on my past Nexus S, but it was
always difficult to type code snippets. When the Galaxy Note
arrived the keyboard was comfy-cozzy and the screen could hold
double the text as my previous phones. I did have to make an
adjustment before I could make use of all those pixels.</p>
<h3>Set DPI of Android OS</h3>
<p>This is a multiple step process consisting of rooting, mounting
<code>/system</code> as read/write, and editing
<code>/system/build.info</code>. <a href=
"http://www.google.com/search?btnG=1&amp;pws=0&amp;q=change+android+dpi">
http://www.google.com/search?btnG=1&amp;pws=0&amp;q=change+android+dpi</a></p>
<h2>Hacker&rsquo;s Keyboard</h2>
<p>This is the keyboard I&rsquo;ve always wanted but don&rsquo;t
have the time to create myself. It is based off the excellent
Gingerbread keyboard and adds the other keys to it. It does it in
such a way that doesn&rsquo;t make the QWERTY keys much small or
obfuscate the location of the symbol keys. My only complaint is
finding the &ldquo;/&rdquo; character. It is hidden behind a long
press of the Speak/Mic key.</p>
<p>In landscape mode the keyboard can turn into a full desktop
keyboard. I have it set to also not do amy typing correction and to
maintain screen overlay mode instead of demoting the screen layout
to show only the input box and the keyboard. Basically landscape is
my coding and SSH home, and portrait is for everything else.</p>
<h2>Writer&rsquo;s App</h2>
<p><a href=
"https://play.google.com/store/apps/details?id=com.jamesmc.writer">https://play.google.com/store/apps/details?id=com.jamesmc.writer</a>
I&rsquo;m writing this whole post in this app while reviewing it. I
have used other apps to write a substantial amount of text, but
this app has one feature that makes it worth while: Markdown syntax
highlighting. It might not mean a lot to most people out there, but
for me using Markdown means I don&rsquo;t have to worry about
styling my text are writing HTML tags and I still get to separate
sections with heads and annotate blocks as code or add
<strong>emphasis</strong> in an unobtrusive way. Having the syntax
highlighting humanizes the text into a readable document so I can
have a preview to how the final audience might see it as I&rsquo;m
still composing it.</p>
<h2>Misc Thoughts</h2>
<ol>
<li>The Note has a slippery back and makes holding the device over
45 degrees a difficult task without putting a finger or two under
the it. My pinky is very tired now and I think I&rsquo;m getting a
rash fromthw USB slot. A rubberized back is probably in order.</li>
<li>The Notes screen is too bright. I seldom use the device
outdoors where the brightness could be useful, but the real
complaint is I can turn the LCD backlighting low enough at night
time which is when I&rsquo;m most prone to write something. Using
an app like Screen Filter [<a href=
"https://play.google.com/store/apps/details?id=com.haxor">https://play.google.com/store/apps/details?id=com.haxor</a>]
helps but washes out colors.</li>
<li>Heat! This might be a feature in the winter, but right now my
hands are getting sweaty which makes thought #1 even more
evident.</li>
<li>Touch typing is possible. I&rsquo;ve been primarily looking a
the text that I&rsquo;m writing and not the kkeyboard. I occasionly
look at the ssuggestion strip for longer words, but with the Note I
finally get to make my high-school typing teacher happy by not
looking at my hands.</li>
</ol>
<h2>Uploading to Posterous</h2>
<p>Posterous is supposed ti be Blogging for the rest of us. Well it
isn&rsquo;t easy for me. The basis work flow in Posterous is to
email the post to <a href=
"mailto:post@posterous.com">post@posterous.com</a> and it
automatically gets to the web nicely formatted. This has yet to
turn out to my satisfaction because it usually messes up the code
snippets or doesn&rsquo;t feature an image I&rsquo;ve attatched.
This means I then have to go to there website and fiddle with it in
the WYSIWYG editor. I&rsquo;ll see what happens when I try to post
this Markdown heavy text.</p>
<h2>Final Thoughts</h2>
<p>Overall, I feel the 3 way combo will allow me to write a bit
more. By nature, I would love to have more time in front of an IDE,
but writing English should do me some good, too.</p>
<p><strong>[Update]</strong> Uploading from Android app still
didn&rsquo;t format the original text correctly, I still had to
tweak in a web browser, ugh!</p>

]]></content>
  </entry>
  
</feed>
