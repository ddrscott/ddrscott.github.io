
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Vim Side Search: Making Search Fun Again - @_ddrscott_</title>
  <meta name="author" content="Scott Pierce">

  
  <meta name="description" content="Vim Side Search: Making Search Fun Again written May 25th, 2016 in vim The quickfix feature is nice, but it doesn&rsquo;t give enough context around &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://ddrscott.github.io/blog/2016/side-search">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="@_ddrscott_" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
</head>

  <body>
    <a href="/" class="home-icon">
      <img src="/images/home.png"/>
    </a>

    <article role="article" class="full-single-article">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <h1>Vim Side Search: Making Search Fun Again</h1>
        <div class="meta">
          written 








  



<time datetime="2016-05-25T09:00:00-05:00" pubdate data-updated="true">May 25<sup>th</sup>, 2016</time>
          

in
<span class="categories">
  
    <a class='category' href='/blog/categories/vim/'>vim</a>
  
</span>


        </div>
        <p><img class="featured" src="/images/vim_ag_unicorn.png" width="699" height="453" title="'Vim + Ag = Unicorn'" ></p>

<p>The <code>quickfix</code> feature is nice, but it doesn&rsquo;t give enough context around the
search term that leads to use <code>ag</code> from terminal and switch back and forth
between programs. I do this search dance every day and I&rsquo;ve had it! There must
be better way!</p>

<!-- more -->


<h2>Problem</h2>

<p><img class="featured" src="/images/side-search-a.png" width="1280" height="1009" title="'Quickfix for help'" >
Look at the <code>quickfix</code> window above. It spends most of its space showing the file name
of the hit, then the remainder is spent on text around it. In projects using
<a href="http://guides.rubyonrails.org/engines.html">Rails Engines</a> with deeply nested
directory structures, this often leaves me with just a bunch of paths in the <code>quickfix</code>.</p>

<h2>Solution A &ndash; The Unix Way</h2>

<p>Some may argue Vim isn&rsquo;t suppose to do search. Vim rightly delegates to the
<a href="http://www.catb.org/esr/writings/taoup/html/ch01s06.html">Unix philosophy</a> by
allowing an external program do its searching. Let&rsquo;s try that for this
solution using <code>grep</code>, <code>ack</code>, and <code>ag</code>.</p>

<p><img class="featured" src="/images/side-search-compare.png" width="1280" height="822" title="'grep vs ack vs ag'" ></p>

<p>We&rsquo;ve run the 3 separate programs (normally, I would only use <code>ag</code>) then
browse the results to see if there&rsquo;s an interesting file. At this point I start
using my handy-dandy mouse to scroll around, precisely highlight the path of
interest, copy, and type <code>vim &lt;Paste&gt;</code>. Intuitive? Yes. Fast? No!</p>

<p>Maybe I should use <code>tmux</code> or <code>screen</code> so I don&rsquo;t need to mouse around, but
trying to select a path is still pretty slow for me and requires more cognitive
load than I have patience for. After all, I&rsquo;m trying to concentrate on a
refactor or something, not how to open a bunch of files. Should I practice more?
Yes. Will I? No!</p>

<p>We&rsquo;re going to use <code>ag</code> from now on, since it&rsquo;s faster than <code>ack</code>, and has
prettier output than <code>grep</code>. I really really really tried to get <code>grep</code> to
output for humans, but couldn&rsquo;t figure it out.</p>

<h2>Solution B &ndash; Vim without Quickfix</h2>

<p>Let Vim do some work for us.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>vim `ag --ignore=\*.{css,scss} -l help` +'/help'</span></code></pre></td></tr></table></div></figure>


<p>What&rsquo;s that?!? Open Vim passing the result of <code>ag</code> command. <code>ag</code> is run with
some file exclusions, <code>-l</code> only file names, and <code>help</code> is the search term.
<code>+'/help'</code> tells Vim to immediately start searching for &lsquo;help&rsquo;.</p>

<p>After all that, Vim should have started with a bunch of buffers. View them with
<code>:ls</code>. Take notice of the buffer numbers to see how many files were found. Use
<code>n</code> and <code>N</code> to jump through search matches in the file. Use <code>:bn</code> to go to the
next buffer and start hitting <code>n</code> again to cycle through the changes. If the
number of files is small enough, you may be able to use <code>:ball</code> to open every
buffer in its own window.</p>

<p>Thats a lot of work to jump through changes. Good thing the <code>quickfix</code> exists.</p>

<h2>Solution C &ndash; Quickfix</h2>

<p>This is here for posterity. <code>quickfix</code> DOES make cycling through changes easier
than Solution B, but as I stated in the intro, it doesn&rsquo;t give the context that
we want.</p>

<p><a href="https://robots.thoughtbot.com/faster-grepping-in-vim">Thoughtbot has a pretty good article</a>
about how to setup Vim to use <code>ag</code>. Once you do that, you can <code>:grep help</code> to
get the following output:</p>

<p><img class="featured" src="/images/side-search-a.png" width="1280" height="1009" title="'Quickfix for help'" ></p>

<p>Use <code>:cnext</code>, <code>:cprev</code>, <code>:cfirst</code>, <code>:clast</code> to go to next, previous, first, and
last <code>quickfix</code> result respectively. Map those to keys to make it easier to
navigate.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nnoremap [q :cprev&lt;CR&gt;
</span><span class='line'>nnoremap ]q :cnext&lt;CR&gt;
</span><span class='line'>nnoremap [Q :cfirst&lt;CR&gt;
</span><span class='line'>nnoremap ]Q :clast&lt;CR&gt;</span></code></pre></td></tr></table></div></figure>


<p>Get more help about <code>quickfix</code> using <code>:help quickfix</code>. Cry after realizing
even <code>:help quickfix</code> can&rsquo;t show more context. I&rsquo;ll be here when you&rsquo;re done.</p>

<h2>Solution D &ndash; Side Search Plugin</h2>

<p>So how do we get the best of both worlds? How do we enter the land of a thousand
wives/husbands? How do we get <code>ag</code> output and quick navigation? For me, it
was writing a plugin in. For you it&rsquo;s using it. <a href="https://github.com/ddrscott/vim-side-search">https://github.com/ddrscott/vim-side-search</a></p>

<p>After installing the plugin using your favorite package manager, you&rsquo;ll have
access to the following functionality:</p>

<p><img class="featured" src="/images/side-search-demo-b.gif" width="1169" height="631" title="'Side Search Demo'" ></p>

<p>Things to notice:</p>

<ul>
<li><code>ag</code> output is in a buffer with additional syntax highlighting!</li>
<li><code>n</code> and <code>N</code> used to jump to matches. Regular Vim navigation works, too!</li>
<li><code>&lt;CR&gt;</code> and <code>&lt;C-w&gt;&lt;CR&gt;</code> used to open change and jump to change!</li>
<li>Number of matches shown in the buffer name!</li>
<li>I use too many exclamation points!!!</li>
</ul>


<p>The plugin&rsquo;s <code>README</code> has more details.</p>

<h2>Closing</h2>

<p>I&rsquo;ve been using this plugin ever since its inception and don&rsquo;t know where I&rsquo;d
be without it. It gets some inspiration from <a href="https://github.com/tpope/vim-fugitive">fugitive&rsquo;s</a>
<code>:Gstatus</code> mode/buffer, and I wish there were more plugins that added
functionality from <code>stdout</code> instead of transforming it into a different format. Unix
tools makers spend a lot of time thinking about the output. Let&rsquo;s use it to our
advantage.</p>

<p>I&rsquo;ve learn a lot creating this plugin and plan to write about it in a future post.
Do you love it or hate it? Have more ideas for Side Search? Please let me know what you
think of it. Have more ideas or issues for Side Search? Hit me up on <a href="https://github.com/ddrscott/vim-side-search">Github</a>.</p>

<h3>References</h3>

<ul>
<li><a href="https://github.com/ggreer/the_silver_searcher">The Silver Searcher</a> by Geoff Greer</li>
<li><code>man ag</code></li>
<li><code>man grep</code></li>
<li><code>man tmux</code></li>
<li><code>man screen</code></li>
<li><code>:help quickfix</code></li>
<li><a href="https://robots.thoughtbot.com/faster-grepping-in-vim">Faster Grepping in Vim</a> by Thoughtbot</li>
<li><a href="https://www.google.com/search?q=the+number+12">The number 12</a></li>
</ul>


      </div>
    </div>
  </div>
</article>

<hr class="divider-short"/>

<div class="archive-link">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        
          <a class="pull-left" href="/blog/2016/sidescroll/" title="Previous Post: Sensible Horizontal Scroll in Vim">&laquo; Previous: Sensible Horizontal Scroll in Vim</a>
        

        
      </div>
    </div>
  </div>
</div>


<section>
    <div class="container">
        <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
            </div>
        </div>
    </div>
</section>


    <footer id="footer" class="her-row">
  <div class="container">
    <div class="row">
      <div class="col-md-1">
  <a href="/"><h4>Home</h4></a>
</div>

<div class="col-md-2">
    <div class="social-icon-list">
        
        <a href="https://twitter.com/@_ddrscott_"><img src="/images/glyphicons_social_31_twitter.png"/></a>
        

        
        <a href="https://github.com/ddrscott"><img src="/images/glyphicons_social_21_github.png"/></a>
        

        <a href="mailto:ddrscott@gmail.com"><img src="/images/glyphicons_social_39_e-mail.png"/></a>
    </div>
</div>

<div class="pull-right">
  <h4>Powered by <a href="http://octopress.org/">Octopress</a>. Designed by <a href="http://AdrianArtiles.com">Adrian Artiles</a>.</h4>
</div>

  <script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-50126719-1', 'auto');
ga('send', 'pageview');
  </script>




<script type="text/javascript">
      var disqus_shortname = 'ddrscottgithubio';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://ddrscott.github.io/blog/2016/side-search/';
        var disqus_url = 'http://ddrscott.github.io/blog/2016/side-search/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>




    </div>
  </div>
</footer>

  </body>
</html>
